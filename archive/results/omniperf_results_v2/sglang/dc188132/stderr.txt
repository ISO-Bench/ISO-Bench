/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/vllm/__init__.py:5: RuntimeWarning: Failed to read commit hash:
No module named 'vllm._version'
  from .version import __version__, __version_tuple__  # isort:skip
Traceback (most recent call last):
  File "/tmp/omniperf_test_jmfilbgp.py", line 115, in setup
    from sglang.srt.mem_cache.memory_pool import MHATokenToKVPool
  File "/tmp/omniperf_worktree_89z9vp41/worktree/python/sglang/srt/mem_cache/memory_pool.py", line 36, in <module>
    from sglang.srt.layers.radix_attention import RadixAttention
  File "/tmp/omniperf_worktree_89z9vp41/worktree/python/sglang/srt/layers/radix_attention.py", line 18, in <module>
    from sglang.srt.model_executor.forward_batch_info import ForwardBatch
  File "/tmp/omniperf_worktree_89z9vp41/worktree/python/sglang/srt/model_executor/forward_batch_info.py", line 40, in <module>
    from sglang.srt.layers.rotary_embedding import MRotaryEmbedding
  File "/tmp/omniperf_worktree_89z9vp41/worktree/python/sglang/srt/layers/rotary_embedding.py", line 9, in <module>
    from vllm.model_executor.custom_op import CustomOp
  File "/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/vllm/__init__.py", line 11, in <module>
    from vllm.engine.arg_utils import AsyncEngineArgs, EngineArgs
  File "/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/vllm/engine/arg_utils.py", line 13, in <module>
    from vllm.config import (CacheConfig, CompilationConfig, ConfigFormat,
  File "/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/vllm/config.py", line 19, in <module>
    from transformers import PretrainedConfig
  File "/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/transformers/__init__.py", line 27, in <module>
    from . import dependency_versions_check
  File "/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/transformers/dependency_versions_check.py", line 57, in <module>
    require_version_core(deps[pkg])
  File "/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/transformers/utils/versions.py", line 117, in require_version_core
    return require_version(requirement, hint)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/transformers/utils/versions.py", line 111, in require_version
    _compare_versions(op, got_ver, want_ver, requirement, pkg, hint)
  File "/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/transformers/utils/versions.py", line 44, in _compare_versions
    raise ImportError(
ImportError: huggingface-hub>=0.34.0,<1.0 is required for a normal functioning of this module, but found huggingface-hub==1.2.3.
Try: `pip install transformers -U` or `pip install -e '.[dev]'` if you're working with git main

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/tmp/omniperf_test_jmfilbgp.py", line 389, in <module>
    run_test(args.eqcheck, args.reference, args.prefix)
  File "/tmp/omniperf_test_jmfilbgp.py", line 320, in run_test
    data = setup()
           ^^^^^^^
  File "/tmp/omniperf_test_jmfilbgp.py", line 158, in setup
    pool = MockPool()
           ^^^^^^^^^^
  File "/tmp/omniperf_test_jmfilbgp.py", line 137, in __init__
    self.k_buffer = [torch.zeros(total_tokens, num_heads, head_dim, device=device, dtype=dtype) 
                                 ^^^^^^^^^^^^
NameError: cannot access free variable 'total_tokens' where it is not associated with a value in enclosing scope
