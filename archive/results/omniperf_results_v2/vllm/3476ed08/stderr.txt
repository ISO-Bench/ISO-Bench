Traceback (most recent call last):
  File "/tmp/omniperf_test_7kro1kh2.py", line 348, in experiment
    block = allocator.allocate_mutable_block(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'CpuGpuBlockAllocator' object has no attribute 'allocate_mutable_block'. Did you mean: 'allocate_mutable'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/tmp/omniperf_test_7kro1kh2.py", line 538, in <module>
    run_test(args.eqcheck, args.reference, args.prefix)
  File "/tmp/omniperf_test_7kro1kh2.py", line 492, in run_test
    result, timing_stats = time_gpu(lambda: experiment(data), warmup=warmup, iterations=iters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/omniperf_test_7kro1kh2.py", line 436, in time_gpu
    _ = func()
        ^^^^^^
  File "/tmp/omniperf_test_7kro1kh2.py", line 492, in <lambda>
    result, timing_stats = time_gpu(lambda: experiment(data), warmup=warmup, iterations=iters)
                                            ^^^^^^^^^^^^^^^^
  File "/tmp/omniperf_test_7kro1kh2.py", line 356, in experiment
    block = allocator.allocate_mutable(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/omniperf_worktree_ri2i5_o4/worktree/vllm/core/block/cpu_gpu_block_allocator.py", line 131, in allocate_mutable
    return self._allocators[device].allocate_mutable(prev_block)
           ~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: device(type='cuda')
