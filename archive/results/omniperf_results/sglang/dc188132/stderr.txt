Traceback (most recent call last):
  File "/tmp/omniperf_test_kwuhzu7z.py", line 115, in setup
    from sglang.srt.mem_cache.memory_pool import MHATokenToKVPool
  File "/tmp/omniperf_worktree_f1c_dkwg/worktree/python/sglang/srt/mem_cache/memory_pool.py", line 36, in <module>
    from sglang.srt.layers.radix_attention import RadixAttention
  File "/tmp/omniperf_worktree_f1c_dkwg/worktree/python/sglang/srt/layers/radix_attention.py", line 18, in <module>
    from sglang.srt.model_executor.forward_batch_info import ForwardBatch
  File "/tmp/omniperf_worktree_f1c_dkwg/worktree/python/sglang/srt/model_executor/forward_batch_info.py", line 41, in <module>
    from sglang.srt.utils import maybe_torch_compile
  File "/tmp/omniperf_worktree_f1c_dkwg/worktree/python/sglang/srt/utils.py", line 56, in <module>
    from triton.runtime.cache import (
ImportError: cannot import name 'default_cache_dir' from 'triton.runtime.cache' (/root/OmniPerf-Bench/bench-env/lib/python3.12/site-packages/triton/runtime/cache.py)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/tmp/omniperf_test_kwuhzu7z.py", line 389, in <module>
    run_test(args.eqcheck, args.reference, args.prefix)
  File "/tmp/omniperf_test_kwuhzu7z.py", line 320, in run_test
    data = setup()
           ^^^^^^^
  File "/tmp/omniperf_test_kwuhzu7z.py", line 158, in setup
    pool = MockPool()
           ^^^^^^^^^^
  File "/tmp/omniperf_test_kwuhzu7z.py", line 137, in __init__
    self.k_buffer = [torch.zeros(total_tokens, num_heads, head_dim, device=device, dtype=dtype) 
                                 ^^^^^^^^^^^^
NameError: cannot access free variable 'total_tokens' where it is not associated with a value in enclosing scope
