{
  "commit_hash": "fa63e710c7fbaae3a445f669d3b5ba6b9a4ef412",
  "pr_url": "https://github.com/vllm-project/vllm/pull/12094",
  "pr_date": "2025-01-15",
  "timeline_text": "Copy link Contributor youngkent commented Jan 15, 2025 ‚Ä¢ edited by github-actions bot Loading Uh oh! There was an error while loading. Please reload this page . We do some runner bookkeeping CPU operations after decoding iteration. We could parallelize some bookkeeping work while waiting on cuda sync. After the cuda sync, we only need to do simple and fast updates. The change should reduce scheduling overhead between decode iterations by ~20%. (See attached gpu trace) Before the optimization, After the optimization, E2E latency benchmark, ran VLLM_USE_V1=1 python3 benchmarks/benchmark_latency.py --model \"/data/users/ktong/llama/llm_8b_oss\" --tensor-parallel-size 1 --input_len 1000 --batch_size 32 Output (1-2% e2e latency reduction): Avg latency: 2.338167402730323 seconds 10% percentile latency: 2.3207896508742123 seconds 25% percentile latency: 2.3264574960339814 seconds 50% percentile latency: 2.3333765944698825 seconds 75% percentile latency: 2.343035737867467 seconds 90% percentile latency: 2.3567665563430635 seconds 99% percentile latency: 2.3934816433605737 seconds Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . üöÄ 3 WoosukKwon, ywang96, and njhill reacted with rocket emoji All reactions üöÄ 3 reactions youngkent requested review from WoosukKwon , njhill , ywang96 and comaniac as code owners January 15, 2025 19:16 Copy link github-actions bot commented Jan 15, 2025 üëã Hi! Thank you for contributing to the vLLM project. Just a reminder: PRs would not trigger full CI run by default. Instead, it would only run fastcheck CI which starts running only a small and essential subset of CI tests to quickly catch errors. You can run other CI tests on top of those by going to your fastcheck build on Buildkite UI (linked in the PR checks section) and unblock them. If you do not have permission to unblock, ping simon-mo or khluu to add you in our Buildkite org. Once the PR is approved and ready to go, your PR reviewer(s) can run CI to test the changes comprehensively before merging. To run CI, PR reviewers can do one of these: Add ready label to the PR Enable auto-merge. üöÄ All reactions Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . mgoin requested a review\n  from robertgshaw2-redhat January 15, 2025 20:20 youngkent added 3 commits January 15, 2025 12:28 reduce scheduling overhead in model runner after cuda sync ‚Ä¶ ff21f9e Signed-off-by: Keyun Tong <tongkeyun@gmail.com> Fix style ‚Ä¶ 41dba06 Signed-off-by: Keyun Tong <tongkeyun@gmail.com> fix style typo ‚Ä¶ 9ce3d6e Signed-off-by: Keyun Tong <tongkeyun@gmail.com> youngkent force-pushed the main branch\n    from 4dc567b to 9ce3d6e Compare January 15, 2025 20:29 youkaichao reviewed Jan 16, 2025 View reviewed changes vllm/v1/outputs.py @@ -8,7 +8,7 @@ class SamplerOutput: # [num_reqs] sampled_token_ids: List[int] Copy link Member youkaichao Jan 16, 2025 There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment is this necessary? iirc, @tlrmchlsmth use List[int] because they are cheaper to serialize, and would benefit tensor parallel case, where we need to pass them across processes. Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . All reactions Copy link Collaborator tlrmchlsmth Jan 16, 2025 There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment This is true  ‚Äî I didn‚Äôt look at how it impacts the non-TP case though Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . All reactions Copy link Collaborator robertgshaw2-redhat Jan 25, 2025 ‚Ä¢ edited Loading Uh oh! There was an error while loading. Please reload this page . There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment The ModelRunnerOutput is what we serialize for TP, we don't serialize the SamplerOutput directly, so this is not a concern Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . All reactions Copy link Collaborator tlrmchlsmth Jan 25, 2025 ‚Ä¢ edited Loading Uh oh! There was an error while loading. Please reload this page . There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment Ah, yep that's right -- I did change this line in #9856 , but that was just downstream of changing sampled_token_ids to a List in the ModelRunnerOutput . This looks good to me since that's left as-is! Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . üëç 1 mgoin reacted with thumbs up emoji All reactions üëç 1 reaction Copy link Collaborator robertgshaw2-redhat commented Jan 16, 2025 Wow, great idea. Im going to run some perfomance analysis on this tomorrow. üëç 1 youngkent reacted with thumbs up emoji All reactions üëç 1 reaction Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . WoosukKwon reviewed Jan 16, 2025 View reviewed changes vllm/v1/worker/gpu_model_runner.py Show resolved Hide resolved Uh oh! There was an error while loading. Please reload this page . njhill reviewed Jan 16, 2025 View reviewed changes vllm/v1/sample/sampler.py Outdated Show resolved Hide resolved Uh oh! There was an error while loading. Please reload this page . njhill mentioned this pull request Jan 17, 2025 [V1] Logprobs and prompt logprobs support #9880 Merged remove outdated comment ‚Ä¶ 8ca382d Signed-off-by: Keyun Tong <tongkeyun@gmail.com> youngkent force-pushed the main branch\n    from dfd825e to 8ca382d Compare January 17, 2025 18:15 youkaichao reviewed Jan 18, 2025 View reviewed changes vllm/v1/outputs.py Show resolved Hide resolved Uh oh! There was an error while loading. Please reload this page . youkaichao reviewed Jan 18, 2025 View reviewed changes vllm/v1/worker/gpu_model_runner.py Show resolved Hide resolved Uh oh! There was an error while loading. Please reload this page . Merge branch 'main' into youngkent/main 1cc6492 WoosukKwon requested a review\n  from alexm-redhat as a code owner January 25, 2025 22:08 WoosukKwon approved these changes Jan 25, 2025 View reviewed changes Copy link Collaborator WoosukKwon left a comment There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment LGTM! Thanks for discovering and fixing this! Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . All reactions vllm/v1/worker/gpu_model_runner.py self.input_batch.req_ids[:num_reqs]), \"req_ids contains None\" req_ids = cast(List[str], self.input_batch.req_ids[:num_reqs]) # NOTE: GPU -> CPU Sync happens here. Copy link Collaborator WoosukKwon Jan 25, 2025 There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment Just for a record: If top-p or top-k sampling is used (with the FlashInfer kernel), CPU-GPU synchronization happens inside the sampler at vllm/vllm/v1/sample/ops/topk_topp_sampler.py Lines 193 to 194\n      in 324960a # NOTE: CPU-GPU synchronization happens here. if not success . all (): Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . üëç 1 youngkent reacted with thumbs up emoji All reactions üëç 1 reaction Copy link Collaborator robertgshaw2-redhat Jan 25, 2025 There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment Do you think we can avoid this in a follow up PR? Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . All reactions Copy link Collaborator WoosukKwon Jan 26, 2025 There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment I don't think we can. This is a fundamental limitation of the kernel (or the algorithm itself). The rejection sampling method cannot 100% guarantee the success. Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . All reactions WoosukKwon added\n  the ready ONLY add when PR is ready to merge/full CI is needed label Jan 25, 2025 tlrmchlsmth approved these changes Jan 25, 2025 View reviewed changes robertgshaw2-redhat reviewed Jan 25, 2025 View reviewed changes vllm/v1/worker/gpu_model_runner.py # NOTE: GPU -> CPU Sync happens here. # Move as many CPU operations as possible before this sync point. sampled_token_ids = sampler_output.sampled_token_ids.tolist() Copy link Collaborator robertgshaw2-redhat Jan 25, 2025 ‚Ä¢ edited Loading Uh oh! There was an error while loading. Please reload this page . There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment It might be faster to do sampler_output.sampled_token_ids.cpu() and then sampler_output.sampled_token_ids[i].item()` in the inner loop. Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . All reactions Copy link Collaborator WoosukKwon Jan 26, 2025 There was a problem hiding this comment. Choose a reason for hiding this comment The reason will be displayed to describe this comment to others. Learn more . Choose a reason Spam Abuse Off Topic Outdated Duplicate Resolved Hide comment In my experience, item() took considerable time so should be avoided. Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . üëç 1 robertgshaw2-redhat reacted with thumbs up emoji All reactions üëç 1 reaction mgoin approved these changes Jan 25, 2025 View reviewed changes Merge remote-tracking branch 'upstream/main' f35e80b Hide details View details WoosukKwon merged commit fa63e71 into vllm-project : main Jan 26, 2025 42 of 44 checks passed Uh oh! There was an error while loading. Please reload this page . Copy link Collaborator WoosukKwon commented Jan 26, 2025 @youngkent Thanks for the PR! This change helps vLLM's performance noticeably. ‚ù§Ô∏è 1 youngkent reacted with heart emoji All reactions ‚ù§Ô∏è 1 reaction Sorry, something went wrong. Uh oh! There was an error while loading. Please reload this page . tjtanaa pushed a commit\n        to EmbeddedLLM/vllm\n      that referenced\n      this pull request Jan 28, 2025 [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( ‚Ä¶ ‚Ä¶ 4388fac ‚Ä¶vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com> rasmith pushed a commit\n        to rasmith/vllm\n      that referenced\n      this pull request Jan 30, 2025 [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( ‚Ä¶ ‚Ä¶ 4a21854 ‚Ä¶vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com> Isotr0py pushed a commit\n        to Isotr0py/vllm\n      that referenced\n      this pull request Feb 2, 2025 [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( ‚Ä¶ ‚Ä¶ 0442131 ‚Ä¶vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com>\nSigned-off-by: Isotr0py <2037008807@qq.com> hongxiayang added a commit\n        to ROCm/vllm\n      that referenced\n      this pull request Feb 3, 2025 [MFM-2025-02-03] Merge Main to llama fp8; With Faster ROCm Paged Atte‚Ä¶ ‚Ä¶ 479b843 ‚Ä¶ntion ( #399 )\n\n* [V1] Avoid sending text prompt to core engine ( vllm-project#11963 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [CI/Build] Add markdown linter ( vllm-project#11857 )\n\nSigned-off-by: Rafael Vasquez <rafvasq21@gmail.com>\n\n* [Model] Initialize support for Deepseek-VL2 models ( vllm-project#11578 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\n\n* [Hardware][CPU] Multi-LoRA implementation for the CPU backend ( vllm-project#11100 )\n\nSigned-off-by: Akshat Tripathi <akshat@krai.ai>\nSigned-off-by: Oleg Mosalov <oleg@krai.ai>\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\nCo-authored-by: Oleg Mosalov <oleg@krai.ai>\nCo-authored-by: Jee Jee Li <pandaleefree@gmail.com>\nCo-authored-by: Isotr0py <2037008807@qq.com>\n\n* [Hardware][TPU] workaround fix for MoE on TPU ( vllm-project#11764 )\n\n* [V1][Core][1/n] Logging and Metrics ( vllm-project#11962 )\n\nSigned-off-by: rshaw@neuralmagic.com <rshaw@neuralmagic.com>\n\n* [Model] Support GGUF models newly added in `transformers` 4.46.0 ( vllm-project#9685 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\n\n* [V1] [2/n] Logging and Metrics - `OutputProcessor` Abstraction ( vllm-project#11973 )\n\nSigned-off-by: rshaw@neuralmagic.com <rshaw@neuralmagic.com>\n\n* [MISC] fix typo in kv transfer send recv test ( vllm-project#11983 )\n\n* [Bug] Fix usage of `.transpose()` and `.view()` consecutively. ( vllm-project#11979 )\n\n* [CI][Spec Decode] fix: broken test for EAGLE model ( vllm-project#11972 )\n\nSigned-off-by: Sungjae Lee <33976427+llsj14@users.noreply.github.com>\n\n* [Misc] Fix Deepseek V2 fp8 kv-scale remapping ( vllm-project#11947 )\n\nSigned-off-by: Yida Wu <yidawu@alumni.cmu.edu>\n\n* [Misc]Minor Changes about Worker ( vllm-project#11555 )\n\nSigned-off-by: Chenguang Li <757486878@qq.com>\n\n* [platform] add ray_device_key ( vllm-project#11948 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* Fix Max Token ID for Qwen-VL-Chat ( vllm-project#11980 )\n\nSigned-off-by: Alex-Brooks <Alex.brooks@ibm.com>\n\n* [Kernel] unified_attention for Attention.forward ( vllm-project#11967 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Doc][V1] Update model implementation guide for V1 support ( vllm-project#11998 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nCo-authored-by: Cyrus Leung <tlleungac@connect.ust.hk>\n\n* [Doc] Organise installation documentation into categories and tabs ( vllm-project#11935 )\n\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\n\n* [platform] add device_control env var ( vllm-project#12009 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Platform] Move get_punica_wrapper() function to Platform ( vllm-project#11516 )\n\nSigned-off-by: Shanshan Shen <467638484@qq.com>\n\n* bugfix: Fix signature mismatch in benchmark's `get_tokenizer` function ( vllm-project#11982 )\n\nSigned-off-by: elijah <f1renze.142857@gmail.com>\n\n* [Doc] Fix build from source and installation link in README.md ( vllm-project#12013 )\n\nSigned-off-by: Yikun <yikunkero@gmail.com>\n\n* Using list\n\n* [Bugfix] Fix deepseekv3 gate bias error ( vllm-project#12002 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\n\n* Revert \"[misc] improve memory profiling ( vllm-project#11809 )\"\n\nThis reverts commit 889e662 .\n\n* Multi-lingual P3L ( #356 )\n\n* Commiting the *multilingual* P3L test.\n\n* Created a *multi-lingual* P3L test.\n\n* Making ruff happy.\n\n* .\n\n* Added a reference to the language-scripture Confluence table.\n\n* Typo fixing.\n\n* Harmonizing naming.\n\n* Fixing comments in the header.\n\n---------\n\nCo-authored-by: Alexei V. Ivanov <alivanov@banff-cyxtera-s65-4.amd.com>\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\n\n* Trying to make scales work with compileable attention\n\n* [Docs] Add Sky Computing Lab to project intro ( vllm-project#12019 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [HPU][Bugfix] set_forward_context and CI test execution ( vllm-project#12014 )\n\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\n\n* [Doc] Update Quantization Hardware Support Documentation ( vllm-project#12025 )\n\nSigned-off-by: tjtanaa <tunjian.tan@embeddedllm.com>\nCo-authored-by: tjtanaa <tunjian.tan@embeddedllm.com>\n\n* [HPU][misc] add comments for explanation ( vllm-project#12034 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix various bugs in multi-modal processor ( vllm-project#12031 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Kernel] Revert the API change of Attention.forward ( vllm-project#12038 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Platform] Add output for Attention Backend ( vllm-project#11981 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix][Kernel] Give unique name to BlockSparseFlashAttention ( vllm-project#12040 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* Explain where the engine args go when using Docker ( vllm-project#12041 )\n\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\n\n* Docs lint\n\n* [Doc]: Update the Json Example of the `Engine Arguments` document ( vllm-project#12045 )\n\n* [Misc]  Merge bitsandbytes_stacked_params_mapping and packed_modules_mapping ( vllm-project#11924 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [Kernel] Support MulAndSilu ( vllm-project#11624 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [HPU][Bugfix] Don't use /dev/accel/accel0 for HPU autodetection in setup.py ( vllm-project#12046 )\n\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\n\n* [Platform] move current_memory_usage() into platform ( vllm-project#11369 )\n\nSigned-off-by: Shanshan Shen <467638484@qq.com>\n\n* [V1][BugFix] Fix edge case in VLM scheduling ( vllm-project#12065 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Misc] Add multipstep chunked-prefill support for FlashInfer ( vllm-project#10467 )\n\n* [core] Turn off GPU communication overlap for Ray executor ( vllm-project#12051 )\n\nSigned-off-by: Rui Qiao <ruisearch42@gmail.com>\n\n* [core] platform agnostic executor via collective_rpc ( vllm-project#11256 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Doc] Update examples to remove SparseAutoModelForCausalLM ( vllm-project#12062 )\n\nSigned-off-by: Kyle Sayers <kylesayrs@gmail.com>\n\n* [V1][Prefix Cache] Move the logic of num_computed_tokens into KVCacheManager ( vllm-project#12003 )\n\n* Fix: cases with empty sparsity config ( vllm-project#12057 )\n\nSigned-off-by: Rahul Tuli <rahul@neuralmagic.com>\n\n* Type-fix: make execute_model output type optional ( vllm-project#12020 )\n\n* [Platform] Do not raise error if _Backend is not found ( vllm-project#12023 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\nCo-authored-by: Mengqing Cao <cmq0113@163.com>\n\n* [Model]: Support internlm3 ( vllm-project#12037 )\n\n* Misc: allow to use proxy in `HTTPConnection` ( vllm-project#12042 )\n\nSigned-off-by: Yuan Zhou <yuan.zhou@intel.com>\n\n* [Misc][Quark] Upstream Quark format to VLLM ( vllm-project#10765 )\n\nSigned-off-by: kewang-xlnx <kewang@xilinx.com>\nSigned-off-by: kewang2 <kewang2@amd.com>\nCo-authored-by: kewang2 <kewang2@amd.com>\nCo-authored-by: Michael Goin <michael@neuralmagic.com>\n\n* [Doc]: Update `OpenAI-Compatible Server` documents ( vllm-project#12082 )\n\n* [Bugfix] use right truncation for non-generative tasks ( vllm-project#12050 )\n\nSigned-off-by: Joe Runde <Joseph.Runde@ibm.com>\n\n* [V1][Core] Autotune encoder cache budget ( vllm-project#11895 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [Bugfix] Fix _get_lora_device for HQQ marlin ( vllm-project#12090 )\n\nSigned-off-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nCo-authored-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\n\n* Allow hip sources to be directly included when compiling for rocm. ( vllm-project#12087 )\n\n* [Core] Default to using per_token quantization for fp8 when cutlass is supported. ( vllm-project#8651 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\n\n* [Doc] Add documentation for specifying model architecture ( vllm-project#12105 )\n\n* Various cosmetic/comment fixes ( vllm-project#12089 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\n\n* [Bugfix] Remove hardcoded `head_size=256` for Deepseek v2 and v3 ( vllm-project#12067 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* Support torchrun and SPMD-style offline inference ( vllm-project#12071 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [core] LLM.collective_rpc interface and RLHF example ( vllm-project#12084 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix max image feature size for Llava-one-vision ( vllm-project#12104 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* Enable user marker for vllm profiling ( #357 )\n\n* Enable user marker for vllm profiling\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\n\n* [misc] Add LoRA kernel micro benchmarks ( vllm-project#11579 )\n\n* [Model] Add support for deepseek-vl2-tiny model ( vllm-project#12068 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* Deepseek V3 support ( #364 )\n\n* Changing the hard coded datatype to see if it's enough for the model to work\n\n* Picking the upstrteam moe kernel version\n\n* make upstream fix for v3 also works for rocm v2\n\n* Conditional fnuz dtype\n\n* Requantizing from fn to fnuz\n\n* Requantizing moe as well\n\n* Actually requantizing moe weights\n\n* Conditional requantization and assert on padding in block quant\n\n* Format\n\n---------\n\nCo-authored-by: charlifu <charlifu@amd.com>\n\n* [Bugfix] Set enforce_eager automatically for mllama ( vllm-project#12127 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Bugfix] Fix a path bug in disaggregated prefill example script. ( vllm-project#12121 )\n\nSigned-off-by: Kuntai Du <kuntai@uchicago.edu>\n\n* [CI]add genai-perf benchmark in nightly benchmark ( vllm-project#10704 )\n\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\n\n* [Doc] Add instructions on using Podman when SELinux is active ( vllm-project#12136 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Bugfix] Fix issues in CPU build Dockerfile ( vllm-project#12135 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [BugFix] add more `is not None` check in VllmConfig.__post_init__ ( vllm-project#12138 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Misc] Add deepseek_vl2 chat template ( vllm-project#12143 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [ROCm][MoE] moe tuning support for rocm ( vllm-project#12049 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [V1] Move more control of kv cache initialization from model_executor to EngineCore ( vllm-project#11960 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: Cody Yu <hao.yu.cody@gmail.com>\n\n* [Misc][LoRA] Improve the readability of LoRA error messages ( vllm-project#12102 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [CI/Build][CPU][Bugfix] Fix CPU CI ( vllm-project#12150 )\n\nSigned-off-by: jiang1.li <jiang1.li@intel.com>\n\n* [core] allow callable in collective_rpc ( vllm-project#12151 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix score api for missing max_model_len validation ( vllm-project#12119 )\n\nSigned-off-by: Wallas Santos <wallashss@ibm.com>\n\n* [Bugfix] Mistral tokenizer encode accept list of str ( vllm-project#12149 )\n\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\n\n* [AMD][FP8] Using MI300 FP8 format on ROCm for block_quant ( vllm-project#12134 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\n\n* [torch.compile] disable logging when cache is disabled ( vllm-project#12043 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [misc] fix cross-node TP ( vllm-project#12166 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [AMD][CI/Build][Bugfix] use pytorch stale wheel ( vllm-project#12172 )\n\nSigned-off-by: hongxyan <hongxyan@amd.com>\n\n* [core] further polish memory profiling ( vllm-project#12126 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Docs] Fix broken link in SECURITY.md ( vllm-project#12175 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [Model] Port deepseek-vl2 processor, remove dependency ( vllm-project#12169 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [core] clean up executor class hierarchy between v1 and v0 ( vllm-project#12171 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Support register quantization method out-of-tree ( vllm-project#11969 )\n\n* [V1] Collect env var for usage stats ( vllm-project#12115 )\n\n* [BUGFIX] Move scores to float32 in case of running xgrammar on cpu ( vllm-project#12152 )\n\nSigned-off-by: Michal Adamczyk <madamczyk@habana.ai>\n\n* [Bugfix] Fix multi-modal processors for transformers 4.48 ( vllm-project#12187 )\n\n* [torch.compile] store inductor compiled Python file ( vllm-project#12182 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* benchmark_serving support --served-model-name param ( vllm-project#12109 )\n\nSigned-off-by: zibai <zibai.gj@alibaba-inc.com>\nCo-authored-by: Roger Wang <136131678+ywang96@users.noreply.github.com>\n\n* [Misc] Add BNB support to GLM4-V model ( vllm-project#12184 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [V1] Add V1 support of Qwen2-VL ( vllm-project#12128 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nCo-authored-by: imkero <kerorek@outlook.com>\nCo-authored-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model] Support for fairseq2 Llama ( vllm-project#11442 )\n\nSigned-off-by: Martin Gleize <mgleize@meta.com>\nCo-authored-by: mgleize user <mgleize@a100-st-p4de24xlarge-4.fair-a100.hpcaas>\n\n* [Bugfix] Fix num_heads value for simple connector when tp enabled ( vllm-project#12074 )\n\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\n\n* [torch.compile] fix sym_tensor_indices ( vllm-project#12191 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* Move linting to `pre-commit` ( vllm-project#11975 )\n\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\n\n* [DOC] Fix typo in docstring and assert message ( vllm-project#12194 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [DOC] Add missing docstring in LLMEngine.add_request() ( vllm-project#12195 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Bugfix] Fix incorrect types in LayerwiseProfileResults ( vllm-project#12196 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Model] Add Qwen2 PRM model support ( vllm-project#12202 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [Core] Interface for accessing model from `VllmRunner` ( vllm-project#10353 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [misc] add placeholder format.sh ( vllm-project#12206 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [CI/Build] Remove dummy CI steps ( vllm-project#12208 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [CI/Build] Make pre-commit faster ( vllm-project#12212 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model] Upgrade Aria to transformers 4.48 ( vllm-project#12203 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [misc] print a message to suggest how to bypass commit hooks ( vllm-project#12217 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [core][bugfix] configure env var during import vllm ( vllm-project#12209 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [V1] Remove `_get_cache_block_size` ( vllm-project#12214 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Misc] Pass `attention` to impl backend ( vllm-project#12218 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix] Fix `HfExampleModels.find_hf_info` ( vllm-project#12223 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [CI] Pass local python version explicitly to pre-commit mypy.sh ( vllm-project#12224 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* Using ROCm6.3.1 base docker and building hipblas-common ( #366 )\n\n* [Misc] Update CODEOWNERS ( vllm-project#12229 )\n\n* fix: update platform detection for M-series arm based MacBook processors ( vllm-project#12227 )\n\nSigned-off-by: isikhi <huseyin.isik000@gmail.com>\n\n* [misc] add cuda runtime version to usage data ( vllm-project#12190 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Roger Wang <ywang@roblox.com>\n\n* [bugfix] catch xgrammar unsupported array constraints ( vllm-project#12210 )\n\nSigned-off-by: Jason Cheng <jasoncky96@gmail.com>\n\n* [Kernel] optimize moe_align_block_size for cuda graph and large num_experts (e.g. DeepSeek-V3) ( vllm-project#12222 )\n\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: Tyler Michael Smith <tyler@neuralmagic.com>\n\n* Add quantization and guided decoding CODEOWNERS ( vllm-project#12228 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\n\n* [AMD][Build] Porting dockerfiles from the ROCm/vllm fork ( vllm-project#11777 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\n\n* [BugFix] Fix GGUF tp>1 when vocab_size is not divisible by 64 ( vllm-project#12230 )\n\nSigned-off-by: NickLucche <nlucches@redhat.com>\n\n* [ci/build] disable failed and flaky tests ( vllm-project#12240 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Rename `MultiModalInputsV2 -> MultiModalInputs` ( vllm-project#12244 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Misc]Add BNB quantization for PaliGemmaForConditionalGeneration  ( vllm-project#12237 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [Misc] Remove redundant TypeVar from base model ( vllm-project#12248 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix] Fix mm_limits access for merged multi-modal processor ( vllm-project#12252 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [torch.compile] transparent compilation with more logging ( vllm-project#12246 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [V1][Bugfix] Fix data item ordering in mixed-modality inference ( vllm-project#12259 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* Remove pytorch comments for outlines + compressed-tensors ( vllm-project#12260 )\n\nSigned-off-by: Thomas Parnell <tpa@zurich.ibm.com>\n\n* [Platform] improve platforms getattr ( vllm-project#12264 )\n\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\n\n* [ci/build] update nightly torch for gh200 test ( vllm-project#12270 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] fix race condition that leads to wrong order of token returned ( vllm-project#10802 )\n\nSigned-off-by: Jannis Sch√∂nleber <joennlae@gmail.com>\n\n* [Kernel] fix moe_align_block_size error condition ( vllm-project#12239 )\n\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\n\n* [v1][stats][1/n] Add RequestStatsUpdate and RequestStats types  ( vllm-project#10907 )\n\nSigned-off-by: rickyx <rickyx@anyscale.com>\n\n* [Bugfix] Multi-sequence broken ( vllm-project#11898 )\n\nSigned-off-by: Andy Lo <andy@mistral.ai>\n\n* [Misc] Remove experimental dep from tracing.py ( vllm-project#12007 )\n\nSigned-off-by: Adrian Cole <adrian.cole@elastic.co>\n\n* [Misc] Set default backend to SDPA for get_vit_attn_backend ( vllm-project#12235 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Core] Free CPU pinned memory on environment cleanup ( vllm-project#10477 )\n\n* Update pre-commit.yml ( #374 )\n\n* Update pre-commit.yml\n\n* Reapplying missing format\n\n* New codespell exclude location\n\n---------\n\nCo-authored-by: Kevin H. Luu <kevin@anyscale.com>\n\n* [bugfix] moe tuning. rm is_navi() ( vllm-project#12273 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [BUGFIX] When skip_tokenize_init and multistep are set, execution crashes ( vllm-project#12277 )\n\nSigned-off-by: maleksan85 <maleksan@amd.com>\nCo-authored-by: maleksan85 <maleksan@amd.com>\n\n* [Documentation][AMD] Add information about prebuilt ROCm vLLM docker for perf validation purpose ( vllm-project#12281 )\n\nSigned-off-by: Hongxia Yang <hongxyan@amd.com>\n\n* [VLM] Simplify post-processing of replacement info ( vllm-project#12269 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [ci/lint] Add back default arg for pre-commit ( vllm-project#12279 )\n\nSigned-off-by: kevin <kevin@anyscale.com>\n\n* [CI] add docker volume prune to neuron CI ( vllm-project#12291 )\n\nSigned-off-by: Liangfu Chen <liangfc@amazon.com>\n\n* [Ci/Build] Fix mypy errors on main ( vllm-project#12296 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Benchmark] More accurate TPOT calc in `benchmark_serving.py` ( vllm-project#12288 )\n\nSigned-off-by: Nick Hill <nhill@redhat.com>\n\n* [core] separate builder init and builder prepare for each batch ( vllm-project#12253 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Build] update requirements of no-device ( vllm-project#12299 )\n\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\n\n* [Core] Support fully transparent sleep mode ( vllm-project#11743 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [VLM] Avoid unnecessary tokenization ( vllm-project#12310 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model][Bugfix]: correct Aria model output ( vllm-project#12309 )\n\nSigned-off-by: xffxff <1247714429@qq.com>\n\n* [Bugfix][VLM] Fix mixed-modality inference backward compatibility for V0 ( vllm-project#12313 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [Doc] Add docs for prompt replacement ( vllm-project#12318 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Misc] Fix the error in the tip for the --lora-modules parameter ( vllm-project#12319 )\n\nSigned-off-by: wangerxiao <863579016@qq.com>\n\n* [Misc]  Improve the readability of BNB error messages  ( vllm-project#12320 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* Skip tokenize/detokenize when it is disabled by arg --skip-tokenizer-init ( #367 )\n\n* switching detokenize flag to be False\n\n* detokenize = False for benchmarks\n\n* restoring default in main vllm code for detokenize\n\n* removing extra spaces\n\n* moving detokenize to flag\n\n* adding support for token ids\n\n---------\n\nCo-authored-by: maleksan85 <maleksan@amd.com>\n\n* [Bugfix] Fix HPU multiprocessing executor ( vllm-project#12167 )\n\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\n\n* [Core] Support `reset_prefix_cache` ( vllm-project#12284 )\n\n* [Frontend][V1] Online serving performance improvements ( vllm-project#12287 )\n\n* [AMD][Quantization] Add TritonScaledMMLinearKernel since int8 is broken for AMD ( vllm-project#12282 )\n\nSigned-off-by: Randall Smith <Randall.Smith@amd.com>\n\n* FP8 FA fixes ( #381 )\n\n* FP8 FA fixes\n\nSummary:\nAdd missing clamp and fix reciprocal scale computation.\n\n* linter\n\n* Returning the use of the proper stream in allreduce ( #382 )\n\n* [Bugfix] Fixing  AMD LoRA CI test. ( vllm-project#12329 )\n\nSigned-off-by: Alexei V. Ivanov <alexei.ivanov@amd.com>\n\n* [Docs] Update FP8 KV Cache documentation ( vllm-project#12238 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\n\n* [Docs] Document vulnerability disclosure process ( vllm-project#12326 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [V1] Add `uncache_blocks` ( vllm-project#12333 )\n\n* [doc] explain common errors around torch.compile ( vllm-project#12340 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Hardware][Gaudi][BugFix] Fix dataclass error due to triton package update ( vllm-project#12338 )\n\nSigned-off-by: zhenwei <zhenweiliu@habana.ai>\n\n* [Bugfix] Fix k_proj's bias for whisper self attention ( vllm-project#12342 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [Kernel] Flash Attention 3 Support ( vllm-project#12093 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* [Doc] Troubleshooting errors during model inspection ( vllm-project#12351 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [V1] Simplify M-RoPE ( vllm-project#12352 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nCo-authored-by: imkero <kerorek@outlook.com>\n\n* [Bugfix] Fix broken internvl2 inference with v1 ( vllm-project#12360 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [core] add wake_up doc and some sanity check ( vllm-project#12361 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [torch.compile] decouple compile sizes and cudagraph sizes ( vllm-project#12243 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [FP8][Kernel] Dynamic kv cache scaling factors computation ( vllm-project#11906 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: Micah Williamson <micah.williamson@amd.com>\n\n* [TPU] Update TPU CI to use torchxla nightly on 20250122 ( vllm-project#12334 )\n\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\n\n* [Docs] Document Phi-4 support ( vllm-project#12362 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [BugFix] Fix parameter names and `process_after_weight_loading` for W4A16 MoE Group Act Order  ( vllm-project#11528 )\n\nSigned-off-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: Michael Goin <michael@neuralmagic.com>\n\n* [Misc] Fix OpenAI API Compatibility Issues in Benchmark Script ( vllm-project#12357 )\n\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\n\n* [Docs] Add meetup slides ( vllm-project#12345 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* Using pytorch commit past the point when rowwise PR ( pytorch/pytorch#144432 ) was merged ( #384 )\n\n* [Docs] Update spec decode + structured output in compat matrix ( vllm-project#12373 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [V1][Frontend] Coalesce bunched `RequestOutput`s ( vllm-project#12298 )\n\nSigned-off-by: Nick Hill <nhill@redhat.com>\nCo-authored-by: Robert Shaw <rshaw@neuralmagic.com>\n\n* Set weights_only=True when using torch.load() ( vllm-project#12366 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [Bugfix] Path join when building local path for S3 clone ( vllm-project#12353 )\n\nSigned-off-by: Omer Dayan (SW-GPU) <omer@run.ai>\n\n* Update compressed-tensors version ( vllm-project#12367 )\n\n* [V1] Increase default batch size for H100/H200 ( vllm-project#12369 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [perf] fix perf regression from vllm-project#12253 ( vllm-project#12380 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Use VisionArena Dataset for VLM Benchmarking ( vllm-project#12389 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [ci/build] fix wheel size check ( vllm-project#12396 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Hardware][Gaudi][Doc] Add missing step in setup instructions ( vllm-project#12382 )\n\n* [ci/build] sync default value for wheel size ( vllm-project#12398 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Enable proxy support in benchmark script ( vllm-project#12356 )\n\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\n\n* [Bugfix][Kernel] Fix CUDA 11.8 being broken by FA3 build ( vllm-project#12375 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* Applying scales rename to fp8 config ( #387 )\n\n* [Misc] Remove deprecated code ( vllm-project#12383 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix][Kernel] FA3 Fix - RuntimeError: This flash attention build only supports pack_gqa (for build size reasons). ( vllm-project#12405 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* Dev-docker Documentation Updates ( #378 )\n\n* Dev-docker Documentation Updates\n\nMinor updates to several sections, with links to other documents where appropriate.\n\n* Fix formatting of GEMM filename\n\n* README cleanup\n\n- Reorder some sections of the README to make them easier to follow\n- Improve formatting of bash commands\n- Prefer use of huggingface model names instead of hard-coded directories\n- Clean up wording\n\n* Expanded sample commands for Latency and Throughput\n\n* Fix markdown links\n\n* Fix pre-commit errors\n\n* Updates from review\n\nInitial updates to incorporate feedback from a review session held with @t-parry * Update script args to match current recommendations\n\n* Remove recommended max-num-seqs values for now\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\n\n* [Bugfix][Kernel] Fix moe align block issue for mixtral ( vllm-project#12413 )\n\n* [Bugfix] Fix BLIP-2 processing ( vllm-project#12412 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [ROCm][MoE] MI300 tuned configs Mixtral-8x(7B,22B) | fp16, fp8 ( vllm-project#12408 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [Misc] Add FA2 support to ViT MHA layer ( vllm-project#12355 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [TPU][CI] Update torchxla version in requirement-tpu.txt ( vllm-project#12422 )\n\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\n\n* [Misc][Bugfix] FA3 support to ViT MHA layer ( vllm-project#12435 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Isotr0py <2037008807@qq.com>\n\n* [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com>\n\n* [V1][Bugfix] Fix assertion when mm hashing is turned off ( vllm-project#12439 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [Misc] Revert FA on ViT vllm-project#12355 and vllm-project#12435 ( vllm-project#12445 )\n\n* [Frontend] generation_config.json for  maximum tokens( vllm-project#12242 )\n\nSigned-off-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\nSigned-off-by: Isotr0py <2037008807@qq.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nCo-authored-by: shangmingc <caishangming@linux.alibaba.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nCo-authored-by: Yuan Tang <terrytangyuan@gmail.com>\nCo-authored-by: Isotr0py <mozf@mail2.sysu.edu.cn>\nCo-authored-by: Cyrus Leung <tlleungac@connect.ust.hk>\nCo-authored-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix] Disable w16a16 2of4 sparse CompressedTensors24 ( vllm-project#12417 )\n\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\n\n* [Bugfix/CI] Fix broken kernels/test_mha.py ( vllm-project#12450 )\n\n* [Bugfix][Kernel] Fix perf regression caused by PR vllm-project#12405 ( vllm-project#12434 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* [Build/CI] Fix libcuda.so linkage ( vllm-project#12424 )\n\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\n\n* [Frontend] Rerank API (Jina- and Cohere-compatible API)  ( vllm-project#12376 )\n\nSigned-off-by: Kyle Mistele <kyle@mistele.com>\n\n* [DOC] Add link to vLLM blog ( vllm-project#12460 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [V1] Avoid list creation in input preparation ( vllm-project#12457 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Frontend] Support scores endpoint in run_batch ( vllm-project#12430 )\n\nSigned-off-by: Pooya Davoodi <pooya.davoodi@parasail.io>\n\n* [Bugfix] Fix Granite 3.0 MoE model loading ( vllm-project#12446 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix] Fix missing seq_start_loc in xformers prefill metadata ( vllm-project#12464 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [V1][Minor] Minor optimizations for update_from_output ( vllm-project#12454 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Bugfix] Fix gpt2 GGUF inference ( vllm-project#12467 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [Build] Only build 9.0a for scaled_mm and sparse kernels ( vllm-project#12339 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* [V1][Metrics] Add initial Prometheus logger ( vllm-project#12416 )\n\nSigned-off-by: Mark McLoughlin <markmc@redhat.com>\n\n* [V1][CI/Test] Do basic test for top-p & top-k sampling ( vllm-project#12469 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [FlashInfer] Upgrade to 0.2.0 ( vllm-project#11194 )\n\nSigned-off-by: Bowen Wang <abmfy@icloud.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\n\n* Support FP8 FA from Quark format ( #388 )\n\n* Support FP8 FA from Quark format\n\n* Support FP8 FA from Quark format\n\n* nit: update comment\n\n* Direct call on ROCm\n\n* 20250127 docs update ( #392 )\n\n* updating code blocks\n\n* typo\n\n* updated manifest\n\n* Including feedback\n\n* whitespace\n\n* Deepseek instructions\n\n* hyperlink fix\n\n* hyperlink fix\n\n* updating what is new\n\n* cpx update\n\n* typo\n\n* whitespace\n\n* whitespace\n\n* Faster Custom Paged Attention kernels ( #372 )\n\n* integrate new cpa kernel, update tests and benchmark\n\n* added comments to mfma4 kernel\n\n* further comments for mfma16 kernel\n\n* clang-format\n\n* Lint\n\n* add flag for logits rtz conversion and disable by default\n\n* lint\n\n* [Bugfix]: Fix paged attention unit tests of #372 ( #389 )\n\n* [Bugfix]: fix paged attention tests based on the updated kernels in `csrc/attention/paged_attention_v1.cu`,`csrc/attention/paged_attention_v2.cu` and  `csrc/rocm/attention.cu`.\n\n* improve code documentation.\n\n* lint\n\n---------\n\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\nCo-authored-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: Joe Shajrawi <17753158+shajrawi@users.noreply.github.com>\nCo-authored-by: TJian <tunjian1996@gmail.com>\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n* Using a more precise profiling on ROCm to properly account for weights padding ( #394 )\n\n* Update Dockerfile.rocm\n\n* [Bugfix]: inclucde the env variables required for running FastSyncLLM\n\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n* fix pre-commit lint\n\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n---------\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: Rafael Vasquez <rafvasq21@gmail.com>\nSigned-off-by: Isotr0py <2037008807@qq.com>\nSigned-off-by: Akshat Tripathi <akshat@krai.ai>\nSigned-off-by: Oleg Mosalov <oleg@krai.ai>\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\nSigned-off-by: rshaw@neuralmagic.com <rshaw@neuralmagic.com>\nSigned-off-by: Sungjae Lee <33976427+llsj14@users.noreply.github.com>\nSigned-off-by: Yida Wu <yidawu@alumni.cmu.edu>\nSigned-off-by: Chenguang Li <757486878@qq.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nSigned-off-by: Alex-Brooks <Alex.brooks@ibm.com>\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nSigned-off-by: Shanshan Shen <467638484@qq.com>\nSigned-off-by: elijah <f1renze.142857@gmail.com>\nSigned-off-by: Yikun <yikunkero@gmail.com>\nSigned-off-by: mgoin <michael@neuralmagic.com>\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\nSigned-off-by: tjtanaa <tunjian.tan@embeddedllm.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nSigned-off-by: yisheng <yi.sheng@intel.com>\nSigned-off-by: Abatom <abzhonghua@gmail.com>\nSigned-off-by: Liangfu Chen <liangfc@amazon.com>\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\nSigned-off-by: Yuan Zhou <yuan.zhou@intel.com>\nSigned-off-by: Sourashis Roy <sroy@roblox.com>\nSigned-off-by: Nishidha Panpaliya <nishidha.panpaliya@partner.ibm.com>\nSigned-off-by: Ilya Lavrenov <ilya.lavrenov@intel.com>\nSigned-off-by: simon-mo <simon.mo@hey.com>\nSigned-off-by: Wallas Santos <wallashss@ibm.com>\nSigned-off-by: jiang1.li <jiang1.li@intel.com>\nSigned-off-by: yan ma <yan.ma@intel.com>\nSigned-off-by: Randall Smith <Randall.Smith@amd.com>\nSigned-off-by: Max de Bayser <mbayser@br.ibm.com>\nSigned-off-by: Maxime Fournioux <55544262+mfournioux@users.noreply.github.com>\nSigned-off-by: Ye Qi <yeq@meta.com>\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\nSigned-off-by: Joe Runde <Joseph.Runde@ibm.com>\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\nSigned-off-by: Kuntai Du <kuntai@uchicago.edu>\nSigned-off-by: Ren MinMin <renmm6@chinaunicom.cn>\nSigned-off-by: Travis Johnson <tsjohnso@us.ibm.com>\nSigned-off-by: Fred Reiss <frreiss@us.ibm.com>\nSigned-off-by: shaochangxu.scx <shaochangxu.scx@antgroup.com>\nSigned-off-by: NickLucche <nlucches@redhat.com>\nSigned-off-by: Rui Qiao <ruisearch42@gmail.com>\nSigned-off-by: Kyle Sayers <kylesayrs@gmail.com>\nSigned-off-by: Rahul Tuli <rahul@neuralmagic.com>\nSigned-off-by: kewang-xlnx <kewang@xilinx.com>\nSigned-off-by: kewang2 <kewang2@amd.com>\nSigned-off-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nSigned-off-by: hongxyan <hongxyan@amd.com>\nSigned-off-by: Michal Adamczyk <madamczyk@habana.ai>\nSigned-off-by: zibai <zibai.gj@alibaba-inc.com>\nSigned-off-by: Martin Gleize <mgleize@meta.com>\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\nSigned-off-by: isikhi <huseyin.isik000@gmail.com>\nSigned-off-by: Jason Cheng <jasoncky96@gmail.com>\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\nSigned-off-by: Thomas Parnell <tpa@zurich.ibm.com>\nSigned-off-by: Jannis Sch√∂nleber <joennlae@gmail.com>\nSigned-off-by: rickyx <rickyx@anyscale.com>\nSigned-off-by: Andy Lo <andy@mistral.ai>\nSigned-off-by: Adrian Cole <adrian.cole@elastic.co>\nSigned-off-by: maleksan85 <maleksan@amd.com>\nSigned-off-by: Hongxia Yang <hongxyan@amd.com>\nSigned-off-by: kevin <kevin@anyscale.com>\nSigned-off-by: Nick Hill <nhill@redhat.com>\nSigned-off-by: xffxff <1247714429@qq.com>\nSigned-off-by: wangerxiao <863579016@qq.com>\nSigned-off-by: Alexei V. Ivanov <alexei.ivanov@amd.com>\nSigned-off-by: zhenwei <zhenweiliu@habana.ai>\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\nSigned-off-by: ElizaWszola <eliza@neuralmagic.com>\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\nSigned-off-by: Omer Dayan (SW-GPU) <omer@run.ai>\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com>\nSigned-off-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\nSigned-off-by: Kyle Mistele <kyle@mistele.com>\nSigned-off-by: Pooya Davoodi <pooya.davoodi@parasail.io>\nSigned-off-by: Mark McLoughlin <markmc@redhat.com>\nSigned-off-by: Bowen Wang <abmfy@icloud.com>\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\nCo-authored-by: Roger Wang <136131678+ywang96@users.noreply.github.com>\nCo-authored-by: Rafael Vasquez <rafvasq21@gmail.com>\nCo-authored-by: Isotr0py <mozf@mail2.sysu.edu.cn>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\nCo-authored-by: Akshat Tripathi <Akshat.tripathi6568@gmail.com>\nCo-authored-by: Oleg Mosalov <oleg@krai.ai>\nCo-authored-by: Jee Jee Li <pandaleefree@gmail.com>\nCo-authored-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Avshalom Manevich <12231371+avshalomman@users.noreply.github.com>\nCo-authored-by: Robert Shaw <114415538+robertgshaw2-neuralmagic@users.noreply.github.com>\nCo-authored-by: Yangcheng Li <liyangcheng.lyc@alibaba-inc.com>\nCo-authored-by: Siyuan Li <94890248+liaoyanqing666@users.noreply.github.com>\nCo-authored-by: Sungjae Lee <33976427+llsj14@users.noreply.github.com>\nCo-authored-by: Concurrensee <yida.wu@amd.com>\nCo-authored-by: Chenguang Li <757486878@qq.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Alex Brooks <alex.brooks@ibm.com>\nCo-authored-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: Cyrus Leung <tlleungac@connect.ust.hk>\nCo-authored-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nCo-authored-by: Shanshan Shen <467638484@qq.com>\nCo-authored-by: elijah <30852919+e1ijah1@users.noreply.github.com>\nCo-authored-by: Yikun Jiang <yikunkero@gmail.com>\nCo-authored-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: Steve Luo <36296769+SunflowerAries@users.noreply.github.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: Alexei-V-Ivanov-AMD <156011006+Alexei-V-Ivanov-AMD@users.noreply.github.com>\nCo-authored-by: Alexei V. Ivanov <alivanov@banff-cyxtera-s65-4.amd.com>\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\nCo-authored-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\nCo-authored-by: Konrad Zawora <kzawora@habana.ai>\nCo-authored-by: wangxiyuan <wangxiyuan1007@gmail.com>\nCo-authored-by: maang-h <55082429+maang-h@users.noreply.github.com>\nCo-authored-by: YiSheng5 <yi.sheng@intel.com>\nCo-authored-by: Zhonghua Deng <abatom@163.com>\nCo-authored-by: Liangfu Chen <liangfc@amazon.com>\nCo-authored-by: XiaobingZhang <xiaobingzhangupc@gmail.com>\nCo-authored-by: Russell Bryant <rbryant@redhat.com>\nCo-authored-by: Yuan <yuan.zhou@intel.com>\nCo-authored-by: jiangjiadi <34134495+jiangjiadi@users.noreply.github.com>\nCo-authored-by: jiadi.jjd <jiadi.jjd@antgroup.com>\nCo-authored-by: sroy745 <142070531+sroy745@users.noreply.github.com>\nCo-authored-by: Jie Fu (ÂÇÖÊù∞) <jiefu@tencent.com>\nCo-authored-by: Divakar Verma <137818590+divakar-amd@users.noreply.github.com>\nCo-authored-by: WangErXiao <863579016@qq.com>\nCo-authored-by: Nishidha <nishidha.panpaliya@partner.ibm.com>\nCo-authored-by: Ilya Lavrenov <ilya.lavrenov@intel.com>\nCo-authored-by: Simon Mo <simon.mo@hey.com>\nCo-authored-by: Wallas Henrique <wallashss@users.noreply.github.com>\nCo-authored-by: Li, Jiang <jiang1.li@intel.com>\nCo-authored-by: Yan Ma <yan.ma@intel.com>\nCo-authored-by: rasmith <Randall.Smith@amd.com>\nCo-authored-by: Tyler Michael Smith <tyler@neuralmagic.com>\nCo-authored-by: Maximilien de Bayser <mbayser@br.ibm.com>\nCo-authored-by: Maxime Fournioux <55544262+mfournioux@users.noreply.github.com>\nCo-authored-by: Guspan Tanadi <36249910+guspan-tanadi@users.noreply.github.com>\nCo-authored-by: Ye (Charlotte) Qi <ye.charlotte.qi@gmail.com>\nCo-authored-by: yeq <yeq@devgpu004.lla3.facebook.com>\nCo-authored-by: Mengqing Cao <cmq0113@163.com>\nCo-authored-by: Charles Frye <cfrye59@gmail.com>\nCo-authored-by: Joe Runde <Joseph.Runde@ibm.com>\nCo-authored-by: Kunshang Ji <kunshang.ji@intel.com>\nCo-authored-by: cennn <61925104+cennn@users.noreply.github.com>\nCo-authored-by: Kuntai Du <kuntai@uchicago.edu>\nCo-authored-by: minmin <rmm0811@gmail.com>\nCo-authored-by: Ren MinMin <renmm6@chinaunicom.cn>\nCo-authored-by: Travis Johnson <tsjohnso@us.ibm.com>\nCo-authored-by: Fred Reiss <frreiss@us.ibm.com>\nCo-authored-by: shaochangxu <85155497+shaochangxu@users.noreply.github.com>\nCo-authored-by: shaochangxu.scx <shaochangxu.scx@antgroup.com>\nCo-authored-by: Nicol√≤ Lucchesi <nlucches@redhat.com>\nCo-authored-by: sixgod <evethwillbeok@outlook.com>\nCo-authored-by: Elfie Guo <164945471+elfiegg@users.noreply.github.com>\nCo-authored-by: Rui Qiao <161574667+ruisearch42@users.noreply.github.com>\nCo-authored-by: Kyle Sayers <kylesayrs@gmail.com>\nCo-authored-by: Rahul Tuli <rahul@neuralmagic.com>\nCo-authored-by: Keyun Tong <tongkeyun@gmail.com>\nCo-authored-by: RunningLeon <maningsheng@sensetime.com>\nCo-authored-by: kewang-xlnx <73578509+kewang-xlnx@users.noreply.github.com>\nCo-authored-by: kewang2 <kewang2@amd.com>\nCo-authored-by: Varun Sundar Rabindranath <varunsundar08@gmail.com>\nCo-authored-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nCo-authored-by: tvirolai-amd <teemu.virolainen@amd.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: Zhaoyi Li <36555117+Lzy17@users.noreply.github.com>\nCo-authored-by: charlifu <charlifu@amd.com>\nCo-authored-by: Yuan Tang <terrytangyuan@gmail.com>\nCo-authored-by: Cody Yu <hao.yu.cody@gmail.com>\nCo-authored-by: Hongxia Yang <62075498+hongxiayang@users.noreply.github.com>\nCo-authored-by: yancong <32220263+ice-tong@users.noreply.github.com>\nCo-authored-by: Michal Adamczyk <madamczyk@habana.ai>\nCo-authored-by: gujing <925973396@qq.com>\nCo-authored-by: imkero <kerorek@outlook.com>\nCo-authored-by: Martin Gleize <mgleize@meta.com>\nCo-authored-by: mgleize user <mgleize@a100-st-p4de24xlarge-4.fair-a100.hpcaas>\nCo-authored-by: shangmingc <caishangming@linux.alibaba.com>\nCo-authored-by: I≈üƒ±k <41375111+isikhi@users.noreply.github.com>\nCo-authored-by: Roger Wang <ywang@roblox.com>\nCo-authored-by: Cheng Kuan Yong Jason <jasoncky96@gmail.com>\nCo-authored-by: Jinzhen Lin <linjinzhen@hotmail.com>\nCo-authored-by: Thomas Parnell <tpa@zurich.ibm.com>\nCo-authored-by: Jannis Sch√∂nleber <joennlae@gmail.com>\nCo-authored-by: Ricky Xu <xuchen727@hotmail.com>\nCo-authored-by: Andy Lo <andylolu24@gmail.com>\nCo-authored-by: Adrian Cole <64215+codefromthecrypt@users.noreply.github.com>\nCo-authored-by: Jani Monoses <jani.monoses@gmail.com>\nCo-authored-by: Kevin H. Luu <kevin@anyscale.com>\nCo-authored-by: Aleksandr Malyshev <164964928+maleksan85@users.noreply.github.com>\nCo-authored-by: maleksan85 <maleksan@amd.com>\nCo-authored-by: Nick Hill <nickhill@us.ibm.com>\nCo-authored-by: zhou fan <1247714429@qq.com>\nCo-authored-by: ilia-cher <30845429+ilia-cher@users.noreply.github.com>\nCo-authored-by: liuzhenwei <zhenweiliu@habana.ai>\nCo-authored-by: Lucas Wilkinson <LucasWilkinson@users.noreply.github.com>\nCo-authored-by: Micah Williamson <micah.williamson@amd.com>\nCo-authored-by: Siyuan Liu <lsiyuan@google.com>\nCo-authored-by: Dipika Sikka <dipikasikka1@gmail.com>\nCo-authored-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\nCo-authored-by: Robert Shaw <rshaw@neuralmagic.com>\nCo-authored-by: omer-dayan <omer@run.ai>\nCo-authored-by: Mohit Deopujari <mdeopujari@habana.ai>\nCo-authored-by: Jeremy Arnold <103538711+JArnoldAMD@users.noreply.github.com>\nCo-authored-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nCo-authored-by: Kyle Mistele <kyle@mistele.com>\nCo-authored-by: Pooya Davoodi <pooya.davoodi@parasail.io>\nCo-authored-by: Mark McLoughlin <markmc@redhat.com>\nCo-authored-by: Bowen Wang <abmfy@icloud.com>\nCo-authored-by: Bowen Bao <bowenbao@amd.com>\nCo-authored-by: arakowsk-amd <182798202+arakowsk-amd@users.noreply.github.com>\nCo-authored-by: sanyalington <shomy.sanyal@amd.com>\nCo-authored-by: Joe Shajrawi <17753158+shajrawi@users.noreply.github.com>\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com> hongxiayang added a commit\n        to ROCm/vllm\n      that referenced\n      this pull request Feb 5, 2025 [Bug Fix] Missing vllm.envs ( #405 ) ‚Ä¶ 87b3c56 * [Model] Initialize support for Deepseek-VL2 models ( vllm-project#11578 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\n\n* [Hardware][CPU] Multi-LoRA implementation for the CPU backend ( vllm-project#11100 )\n\nSigned-off-by: Akshat Tripathi <akshat@krai.ai>\nSigned-off-by: Oleg Mosalov <oleg@krai.ai>\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\nCo-authored-by: Oleg Mosalov <oleg@krai.ai>\nCo-authored-by: Jee Jee Li <pandaleefree@gmail.com>\nCo-authored-by: Isotr0py <2037008807@qq.com>\n\n* [Hardware][TPU] workaround fix for MoE on TPU ( vllm-project#11764 )\n\n* [V1][Core][1/n] Logging and Metrics ( vllm-project#11962 )\n\nSigned-off-by: rshaw@neuralmagic.com <rshaw@neuralmagic.com>\n\n* [Model] Support GGUF models newly added in `transformers` 4.46.0 ( vllm-project#9685 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\n\n* [V1] [2/n] Logging and Metrics - `OutputProcessor` Abstraction ( vllm-project#11973 )\n\nSigned-off-by: rshaw@neuralmagic.com <rshaw@neuralmagic.com>\n\n* [MISC] fix typo in kv transfer send recv test ( vllm-project#11983 )\n\n* [Bug] Fix usage of `.transpose()` and `.view()` consecutively. ( vllm-project#11979 )\n\n* [CI][Spec Decode] fix: broken test for EAGLE model ( vllm-project#11972 )\n\nSigned-off-by: Sungjae Lee <33976427+llsj14@users.noreply.github.com>\n\n* [Misc] Fix Deepseek V2 fp8 kv-scale remapping ( vllm-project#11947 )\n\nSigned-off-by: Yida Wu <yidawu@alumni.cmu.edu>\n\n* [Misc]Minor Changes about Worker ( vllm-project#11555 )\n\nSigned-off-by: Chenguang Li <757486878@qq.com>\n\n* [platform] add ray_device_key ( vllm-project#11948 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* Fix Max Token ID for Qwen-VL-Chat ( vllm-project#11980 )\n\nSigned-off-by: Alex-Brooks <Alex.brooks@ibm.com>\n\n* [Kernel] unified_attention for Attention.forward ( vllm-project#11967 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Doc][V1] Update model implementation guide for V1 support ( vllm-project#11998 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nCo-authored-by: Cyrus Leung <tlleungac@connect.ust.hk>\n\n* [Doc] Organise installation documentation into categories and tabs ( vllm-project#11935 )\n\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\n\n* [platform] add device_control env var ( vllm-project#12009 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Platform] Move get_punica_wrapper() function to Platform ( vllm-project#11516 )\n\nSigned-off-by: Shanshan Shen <467638484@qq.com>\n\n* bugfix: Fix signature mismatch in benchmark's `get_tokenizer` function ( vllm-project#11982 )\n\nSigned-off-by: elijah <f1renze.142857@gmail.com>\n\n* [Doc] Fix build from source and installation link in README.md ( vllm-project#12013 )\n\nSigned-off-by: Yikun <yikunkero@gmail.com>\n\n* Using list\n\n* [Bugfix] Fix deepseekv3 gate bias error ( vllm-project#12002 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\n\n* Revert \"[misc] improve memory profiling ( vllm-project#11809 )\"\n\nThis reverts commit 889e662 .\n\n* Multi-lingual P3L ( #356 )\n\n* Commiting the *multilingual* P3L test.\n\n* Created a *multi-lingual* P3L test.\n\n* Making ruff happy.\n\n* .\n\n* Added a reference to the language-scripture Confluence table.\n\n* Typo fixing.\n\n* Harmonizing naming.\n\n* Fixing comments in the header.\n\n---------\n\nCo-authored-by: Alexei V. Ivanov <alivanov@banff-cyxtera-s65-4.amd.com>\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\n\n* Trying to make scales work with compileable attention\n\n* [Docs] Add Sky Computing Lab to project intro ( vllm-project#12019 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [HPU][Bugfix] set_forward_context and CI test execution ( vllm-project#12014 )\n\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\n\n* [Doc] Update Quantization Hardware Support Documentation ( vllm-project#12025 )\n\nSigned-off-by: tjtanaa <tunjian.tan@embeddedllm.com>\nCo-authored-by: tjtanaa <tunjian.tan@embeddedllm.com>\n\n* [HPU][misc] add comments for explanation ( vllm-project#12034 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix various bugs in multi-modal processor ( vllm-project#12031 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Kernel] Revert the API change of Attention.forward ( vllm-project#12038 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Platform] Add output for Attention Backend ( vllm-project#11981 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix][Kernel] Give unique name to BlockSparseFlashAttention ( vllm-project#12040 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* Explain where the engine args go when using Docker ( vllm-project#12041 )\n\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\n\n* Docs lint\n\n* [Doc]: Update the Json Example of the `Engine Arguments` document ( vllm-project#12045 )\n\n* [Misc]  Merge bitsandbytes_stacked_params_mapping and packed_modules_mapping ( vllm-project#11924 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [Kernel] Support MulAndSilu ( vllm-project#11624 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [HPU][Bugfix] Don't use /dev/accel/accel0 for HPU autodetection in setup.py ( vllm-project#12046 )\n\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\n\n* [Platform] move current_memory_usage() into platform ( vllm-project#11369 )\n\nSigned-off-by: Shanshan Shen <467638484@qq.com>\n\n* [V1][BugFix] Fix edge case in VLM scheduling ( vllm-project#12065 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Misc] Add multipstep chunked-prefill support for FlashInfer ( vllm-project#10467 )\n\n* [core] Turn off GPU communication overlap for Ray executor ( vllm-project#12051 )\n\nSigned-off-by: Rui Qiao <ruisearch42@gmail.com>\n\n* [core] platform agnostic executor via collective_rpc ( vllm-project#11256 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Doc] Update examples to remove SparseAutoModelForCausalLM ( vllm-project#12062 )\n\nSigned-off-by: Kyle Sayers <kylesayrs@gmail.com>\n\n* [V1][Prefix Cache] Move the logic of num_computed_tokens into KVCacheManager ( vllm-project#12003 )\n\n* Fix: cases with empty sparsity config ( vllm-project#12057 )\n\nSigned-off-by: Rahul Tuli <rahul@neuralmagic.com>\n\n* Type-fix: make execute_model output type optional ( vllm-project#12020 )\n\n* [Platform] Do not raise error if _Backend is not found ( vllm-project#12023 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\nCo-authored-by: Mengqing Cao <cmq0113@163.com>\n\n* [Model]: Support internlm3 ( vllm-project#12037 )\n\n* Misc: allow to use proxy in `HTTPConnection` ( vllm-project#12042 )\n\nSigned-off-by: Yuan Zhou <yuan.zhou@intel.com>\n\n* [Misc][Quark] Upstream Quark format to VLLM ( vllm-project#10765 )\n\nSigned-off-by: kewang-xlnx <kewang@xilinx.com>\nSigned-off-by: kewang2 <kewang2@amd.com>\nCo-authored-by: kewang2 <kewang2@amd.com>\nCo-authored-by: Michael Goin <michael@neuralmagic.com>\n\n* [Doc]: Update `OpenAI-Compatible Server` documents ( vllm-project#12082 )\n\n* [Bugfix] use right truncation for non-generative tasks ( vllm-project#12050 )\n\nSigned-off-by: Joe Runde <Joseph.Runde@ibm.com>\n\n* [V1][Core] Autotune encoder cache budget ( vllm-project#11895 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [Bugfix] Fix _get_lora_device for HQQ marlin ( vllm-project#12090 )\n\nSigned-off-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nCo-authored-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\n\n* Allow hip sources to be directly included when compiling for rocm. ( vllm-project#12087 )\n\n* [Core] Default to using per_token quantization for fp8 when cutlass is supported. ( vllm-project#8651 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\n\n* [Doc] Add documentation for specifying model architecture ( vllm-project#12105 )\n\n* Various cosmetic/comment fixes ( vllm-project#12089 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\n\n* [Bugfix] Remove hardcoded `head_size=256` for Deepseek v2 and v3 ( vllm-project#12067 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* Support torchrun and SPMD-style offline inference ( vllm-project#12071 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [core] LLM.collective_rpc interface and RLHF example ( vllm-project#12084 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix max image feature size for Llava-one-vision ( vllm-project#12104 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* Enable user marker for vllm profiling ( #357 )\n\n* Enable user marker for vllm profiling\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\n\n* [misc] Add LoRA kernel micro benchmarks ( vllm-project#11579 )\n\n* [Model] Add support for deepseek-vl2-tiny model ( vllm-project#12068 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* Deepseek V3 support ( #364 )\n\n* Changing the hard coded datatype to see if it's enough for the model to work\n\n* Picking the upstrteam moe kernel version\n\n* make upstream fix for v3 also works for rocm v2\n\n* Conditional fnuz dtype\n\n* Requantizing from fn to fnuz\n\n* Requantizing moe as well\n\n* Actually requantizing moe weights\n\n* Conditional requantization and assert on padding in block quant\n\n* Format\n\n---------\n\nCo-authored-by: charlifu <charlifu@amd.com>\n\n* [Bugfix] Set enforce_eager automatically for mllama ( vllm-project#12127 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Bugfix] Fix a path bug in disaggregated prefill example script. ( vllm-project#12121 )\n\nSigned-off-by: Kuntai Du <kuntai@uchicago.edu>\n\n* [CI]add genai-perf benchmark in nightly benchmark ( vllm-project#10704 )\n\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\n\n* [Doc] Add instructions on using Podman when SELinux is active ( vllm-project#12136 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Bugfix] Fix issues in CPU build Dockerfile ( vllm-project#12135 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [BugFix] add more `is not None` check in VllmConfig.__post_init__ ( vllm-project#12138 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Misc] Add deepseek_vl2 chat template ( vllm-project#12143 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [ROCm][MoE] moe tuning support for rocm ( vllm-project#12049 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [V1] Move more control of kv cache initialization from model_executor to EngineCore ( vllm-project#11960 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: Cody Yu <hao.yu.cody@gmail.com>\n\n* [Misc][LoRA] Improve the readability of LoRA error messages ( vllm-project#12102 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [CI/Build][CPU][Bugfix] Fix CPU CI ( vllm-project#12150 )\n\nSigned-off-by: jiang1.li <jiang1.li@intel.com>\n\n* [core] allow callable in collective_rpc ( vllm-project#12151 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix score api for missing max_model_len validation ( vllm-project#12119 )\n\nSigned-off-by: Wallas Santos <wallashss@ibm.com>\n\n* [Bugfix] Mistral tokenizer encode accept list of str ( vllm-project#12149 )\n\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\n\n* [AMD][FP8] Using MI300 FP8 format on ROCm for block_quant ( vllm-project#12134 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\n\n* [torch.compile] disable logging when cache is disabled ( vllm-project#12043 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [misc] fix cross-node TP ( vllm-project#12166 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [AMD][CI/Build][Bugfix] use pytorch stale wheel ( vllm-project#12172 )\n\nSigned-off-by: hongxyan <hongxyan@amd.com>\n\n* [core] further polish memory profiling ( vllm-project#12126 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Docs] Fix broken link in SECURITY.md ( vllm-project#12175 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [Model] Port deepseek-vl2 processor, remove dependency ( vllm-project#12169 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [core] clean up executor class hierarchy between v1 and v0 ( vllm-project#12171 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Support register quantization method out-of-tree ( vllm-project#11969 )\n\n* [V1] Collect env var for usage stats ( vllm-project#12115 )\n\n* [BUGFIX] Move scores to float32 in case of running xgrammar on cpu ( vllm-project#12152 )\n\nSigned-off-by: Michal Adamczyk <madamczyk@habana.ai>\n\n* [Bugfix] Fix multi-modal processors for transformers 4.48 ( vllm-project#12187 )\n\n* [torch.compile] store inductor compiled Python file ( vllm-project#12182 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* benchmark_serving support --served-model-name param ( vllm-project#12109 )\n\nSigned-off-by: zibai <zibai.gj@alibaba-inc.com>\nCo-authored-by: Roger Wang <136131678+ywang96@users.noreply.github.com>\n\n* [Misc] Add BNB support to GLM4-V model ( vllm-project#12184 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [V1] Add V1 support of Qwen2-VL ( vllm-project#12128 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nCo-authored-by: imkero <kerorek@outlook.com>\nCo-authored-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model] Support for fairseq2 Llama ( vllm-project#11442 )\n\nSigned-off-by: Martin Gleize <mgleize@meta.com>\nCo-authored-by: mgleize user <mgleize@a100-st-p4de24xlarge-4.fair-a100.hpcaas>\n\n* [Bugfix] Fix num_heads value for simple connector when tp enabled ( vllm-project#12074 )\n\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\n\n* [torch.compile] fix sym_tensor_indices ( vllm-project#12191 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* Move linting to `pre-commit` ( vllm-project#11975 )\n\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\n\n* [DOC] Fix typo in docstring and assert message ( vllm-project#12194 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [DOC] Add missing docstring in LLMEngine.add_request() ( vllm-project#12195 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Bugfix] Fix incorrect types in LayerwiseProfileResults ( vllm-project#12196 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Model] Add Qwen2 PRM model support ( vllm-project#12202 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [Core] Interface for accessing model from `VllmRunner` ( vllm-project#10353 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [misc] add placeholder format.sh ( vllm-project#12206 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [CI/Build] Remove dummy CI steps ( vllm-project#12208 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [CI/Build] Make pre-commit faster ( vllm-project#12212 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model] Upgrade Aria to transformers 4.48 ( vllm-project#12203 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [misc] print a message to suggest how to bypass commit hooks ( vllm-project#12217 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [core][bugfix] configure env var during import vllm ( vllm-project#12209 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [V1] Remove `_get_cache_block_size` ( vllm-project#12214 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Misc] Pass `attention` to impl backend ( vllm-project#12218 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix] Fix `HfExampleModels.find_hf_info` ( vllm-project#12223 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [CI] Pass local python version explicitly to pre-commit mypy.sh ( vllm-project#12224 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* Using ROCm6.3.1 base docker and building hipblas-common ( #366 )\n\n* [Misc] Update CODEOWNERS ( vllm-project#12229 )\n\n* fix: update platform detection for M-series arm based MacBook processors ( vllm-project#12227 )\n\nSigned-off-by: isikhi <huseyin.isik000@gmail.com>\n\n* [misc] add cuda runtime version to usage data ( vllm-project#12190 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Roger Wang <ywang@roblox.com>\n\n* [bugfix] catch xgrammar unsupported array constraints ( vllm-project#12210 )\n\nSigned-off-by: Jason Cheng <jasoncky96@gmail.com>\n\n* [Kernel] optimize moe_align_block_size for cuda graph and large num_experts (e.g. DeepSeek-V3) ( vllm-project#12222 )\n\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: Tyler Michael Smith <tyler@neuralmagic.com>\n\n* Add quantization and guided decoding CODEOWNERS ( vllm-project#12228 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\n\n* [AMD][Build] Porting dockerfiles from the ROCm/vllm fork ( vllm-project#11777 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\n\n* [BugFix] Fix GGUF tp>1 when vocab_size is not divisible by 64 ( vllm-project#12230 )\n\nSigned-off-by: NickLucche <nlucches@redhat.com>\n\n* [ci/build] disable failed and flaky tests ( vllm-project#12240 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Rename `MultiModalInputsV2 -> MultiModalInputs` ( vllm-project#12244 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Misc]Add BNB quantization for PaliGemmaForConditionalGeneration  ( vllm-project#12237 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [Misc] Remove redundant TypeVar from base model ( vllm-project#12248 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix] Fix mm_limits access for merged multi-modal processor ( vllm-project#12252 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [torch.compile] transparent compilation with more logging ( vllm-project#12246 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [V1][Bugfix] Fix data item ordering in mixed-modality inference ( vllm-project#12259 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* Remove pytorch comments for outlines + compressed-tensors ( vllm-project#12260 )\n\nSigned-off-by: Thomas Parnell <tpa@zurich.ibm.com>\n\n* [Platform] improve platforms getattr ( vllm-project#12264 )\n\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\n\n* [ci/build] update nightly torch for gh200 test ( vllm-project#12270 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] fix race condition that leads to wrong order of token returned ( vllm-project#10802 )\n\nSigned-off-by: Jannis Sch√∂nleber <joennlae@gmail.com>\n\n* [Kernel] fix moe_align_block_size error condition ( vllm-project#12239 )\n\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\n\n* [v1][stats][1/n] Add RequestStatsUpdate and RequestStats types  ( vllm-project#10907 )\n\nSigned-off-by: rickyx <rickyx@anyscale.com>\n\n* [Bugfix] Multi-sequence broken ( vllm-project#11898 )\n\nSigned-off-by: Andy Lo <andy@mistral.ai>\n\n* [Misc] Remove experimental dep from tracing.py ( vllm-project#12007 )\n\nSigned-off-by: Adrian Cole <adrian.cole@elastic.co>\n\n* [Misc] Set default backend to SDPA for get_vit_attn_backend ( vllm-project#12235 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Core] Free CPU pinned memory on environment cleanup ( vllm-project#10477 )\n\n* Update pre-commit.yml ( #374 )\n\n* Update pre-commit.yml\n\n* Reapplying missing format\n\n* New codespell exclude location\n\n---------\n\nCo-authored-by: Kevin H. Luu <kevin@anyscale.com>\n\n* [bugfix] moe tuning. rm is_navi() ( vllm-project#12273 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [BUGFIX] When skip_tokenize_init and multistep are set, execution crashes ( vllm-project#12277 )\n\nSigned-off-by: maleksan85 <maleksan@amd.com>\nCo-authored-by: maleksan85 <maleksan@amd.com>\n\n* [Documentation][AMD] Add information about prebuilt ROCm vLLM docker for perf validation purpose ( vllm-project#12281 )\n\nSigned-off-by: Hongxia Yang <hongxyan@amd.com>\n\n* [VLM] Simplify post-processing of replacement info ( vllm-project#12269 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [ci/lint] Add back default arg for pre-commit ( vllm-project#12279 )\n\nSigned-off-by: kevin <kevin@anyscale.com>\n\n* [CI] add docker volume prune to neuron CI ( vllm-project#12291 )\n\nSigned-off-by: Liangfu Chen <liangfc@amazon.com>\n\n* [Ci/Build] Fix mypy errors on main ( vllm-project#12296 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Benchmark] More accurate TPOT calc in `benchmark_serving.py` ( vllm-project#12288 )\n\nSigned-off-by: Nick Hill <nhill@redhat.com>\n\n* [core] separate builder init and builder prepare for each batch ( vllm-project#12253 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Build] update requirements of no-device ( vllm-project#12299 )\n\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\n\n* [Core] Support fully transparent sleep mode ( vllm-project#11743 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [VLM] Avoid unnecessary tokenization ( vllm-project#12310 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model][Bugfix]: correct Aria model output ( vllm-project#12309 )\n\nSigned-off-by: xffxff <1247714429@qq.com>\n\n* [Bugfix][VLM] Fix mixed-modality inference backward compatibility for V0 ( vllm-project#12313 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [Doc] Add docs for prompt replacement ( vllm-project#12318 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Misc] Fix the error in the tip for the --lora-modules parameter ( vllm-project#12319 )\n\nSigned-off-by: wangerxiao <863579016@qq.com>\n\n* [Misc]  Improve the readability of BNB error messages  ( vllm-project#12320 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* Skip tokenize/detokenize when it is disabled by arg --skip-tokenizer-init ( #367 )\n\n* switching detokenize flag to be False\n\n* detokenize = False for benchmarks\n\n* restoring default in main vllm code for detokenize\n\n* removing extra spaces\n\n* moving detokenize to flag\n\n* adding support for token ids\n\n---------\n\nCo-authored-by: maleksan85 <maleksan@amd.com>\n\n* [Bugfix] Fix HPU multiprocessing executor ( vllm-project#12167 )\n\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\n\n* [Core] Support `reset_prefix_cache` ( vllm-project#12284 )\n\n* [Frontend][V1] Online serving performance improvements ( vllm-project#12287 )\n\n* [AMD][Quantization] Add TritonScaledMMLinearKernel since int8 is broken for AMD ( vllm-project#12282 )\n\nSigned-off-by: Randall Smith <Randall.Smith@amd.com>\n\n* FP8 FA fixes ( #381 )\n\n* FP8 FA fixes\n\nSummary:\nAdd missing clamp and fix reciprocal scale computation.\n\n* linter\n\n* Returning the use of the proper stream in allreduce ( #382 )\n\n* [Bugfix] Fixing  AMD LoRA CI test. ( vllm-project#12329 )\n\nSigned-off-by: Alexei V. Ivanov <alexei.ivanov@amd.com>\n\n* [Docs] Update FP8 KV Cache documentation ( vllm-project#12238 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\n\n* [Docs] Document vulnerability disclosure process ( vllm-project#12326 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [V1] Add `uncache_blocks` ( vllm-project#12333 )\n\n* [doc] explain common errors around torch.compile ( vllm-project#12340 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Hardware][Gaudi][BugFix] Fix dataclass error due to triton package update ( vllm-project#12338 )\n\nSigned-off-by: zhenwei <zhenweiliu@habana.ai>\n\n* [Bugfix] Fix k_proj's bias for whisper self attention ( vllm-project#12342 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [Kernel] Flash Attention 3 Support ( vllm-project#12093 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* [Doc] Troubleshooting errors during model inspection ( vllm-project#12351 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [V1] Simplify M-RoPE ( vllm-project#12352 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nCo-authored-by: imkero <kerorek@outlook.com>\n\n* [Bugfix] Fix broken internvl2 inference with v1 ( vllm-project#12360 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [core] add wake_up doc and some sanity check ( vllm-project#12361 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [torch.compile] decouple compile sizes and cudagraph sizes ( vllm-project#12243 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [FP8][Kernel] Dynamic kv cache scaling factors computation ( vllm-project#11906 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: Micah Williamson <micah.williamson@amd.com>\n\n* [TPU] Update TPU CI to use torchxla nightly on 20250122 ( vllm-project#12334 )\n\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\n\n* [Docs] Document Phi-4 support ( vllm-project#12362 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [BugFix] Fix parameter names and `process_after_weight_loading` for W4A16 MoE Group Act Order  ( vllm-project#11528 )\n\nSigned-off-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: Michael Goin <michael@neuralmagic.com>\n\n* [Misc] Fix OpenAI API Compatibility Issues in Benchmark Script ( vllm-project#12357 )\n\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\n\n* [Docs] Add meetup slides ( vllm-project#12345 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* Using pytorch commit past the point when rowwise PR ( pytorch/pytorch#144432 ) was merged ( #384 )\n\n* [Docs] Update spec decode + structured output in compat matrix ( vllm-project#12373 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [V1][Frontend] Coalesce bunched `RequestOutput`s ( vllm-project#12298 )\n\nSigned-off-by: Nick Hill <nhill@redhat.com>\nCo-authored-by: Robert Shaw <rshaw@neuralmagic.com>\n\n* Set weights_only=True when using torch.load() ( vllm-project#12366 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [Bugfix] Path join when building local path for S3 clone ( vllm-project#12353 )\n\nSigned-off-by: Omer Dayan (SW-GPU) <omer@run.ai>\n\n* Update compressed-tensors version ( vllm-project#12367 )\n\n* [V1] Increase default batch size for H100/H200 ( vllm-project#12369 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [perf] fix perf regression from vllm-project#12253 ( vllm-project#12380 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Use VisionArena Dataset for VLM Benchmarking ( vllm-project#12389 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [ci/build] fix wheel size check ( vllm-project#12396 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Hardware][Gaudi][Doc] Add missing step in setup instructions ( vllm-project#12382 )\n\n* [ci/build] sync default value for wheel size ( vllm-project#12398 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Enable proxy support in benchmark script ( vllm-project#12356 )\n\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\n\n* [Bugfix][Kernel] Fix CUDA 11.8 being broken by FA3 build ( vllm-project#12375 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* Applying scales rename to fp8 config ( #387 )\n\n* [Misc] Remove deprecated code ( vllm-project#12383 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix][Kernel] FA3 Fix - RuntimeError: This flash attention build only supports pack_gqa (for build size reasons). ( vllm-project#12405 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* Dev-docker Documentation Updates ( #378 )\n\n* Dev-docker Documentation Updates\n\nMinor updates to several sections, with links to other documents where appropriate.\n\n* Fix formatting of GEMM filename\n\n* README cleanup\n\n- Reorder some sections of the README to make them easier to follow\n- Improve formatting of bash commands\n- Prefer use of huggingface model names instead of hard-coded directories\n- Clean up wording\n\n* Expanded sample commands for Latency and Throughput\n\n* Fix markdown links\n\n* Fix pre-commit errors\n\n* Updates from review\n\nInitial updates to incorporate feedback from a review session held with @t-parry * Update script args to match current recommendations\n\n* Remove recommended max-num-seqs values for now\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\n\n* [Bugfix][Kernel] Fix moe align block issue for mixtral ( vllm-project#12413 )\n\n* [Bugfix] Fix BLIP-2 processing ( vllm-project#12412 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [ROCm][MoE] MI300 tuned configs Mixtral-8x(7B,22B) | fp16, fp8 ( vllm-project#12408 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [Misc] Add FA2 support to ViT MHA layer ( vllm-project#12355 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [TPU][CI] Update torchxla version in requirement-tpu.txt ( vllm-project#12422 )\n\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\n\n* [Misc][Bugfix] FA3 support to ViT MHA layer ( vllm-project#12435 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Isotr0py <2037008807@qq.com>\n\n* [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com>\n\n* [V1][Bugfix] Fix assertion when mm hashing is turned off ( vllm-project#12439 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [Misc] Revert FA on ViT vllm-project#12355 and vllm-project#12435 ( vllm-project#12445 )\n\n* [Frontend] generation_config.json for  maximum tokens( vllm-project#12242 )\n\nSigned-off-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\nSigned-off-by: Isotr0py <2037008807@qq.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nCo-authored-by: shangmingc <caishangming@linux.alibaba.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nCo-authored-by: Yuan Tang <terrytangyuan@gmail.com>\nCo-authored-by: Isotr0py <mozf@mail2.sysu.edu.cn>\nCo-authored-by: Cyrus Leung <tlleungac@connect.ust.hk>\nCo-authored-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix] Disable w16a16 2of4 sparse CompressedTensors24 ( vllm-project#12417 )\n\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\n\n* [Bugfix/CI] Fix broken kernels/test_mha.py ( vllm-project#12450 )\n\n* [Bugfix][Kernel] Fix perf regression caused by PR vllm-project#12405 ( vllm-project#12434 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* [Build/CI] Fix libcuda.so linkage ( vllm-project#12424 )\n\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\n\n* [Frontend] Rerank API (Jina- and Cohere-compatible API)  ( vllm-project#12376 )\n\nSigned-off-by: Kyle Mistele <kyle@mistele.com>\n\n* [DOC] Add link to vLLM blog ( vllm-project#12460 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [V1] Avoid list creation in input preparation ( vllm-project#12457 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Frontend] Support scores endpoint in run_batch ( vllm-project#12430 )\n\nSigned-off-by: Pooya Davoodi <pooya.davoodi@parasail.io>\n\n* [Bugfix] Fix Granite 3.0 MoE model loading ( vllm-project#12446 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix] Fix missing seq_start_loc in xformers prefill metadata ( vllm-project#12464 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [V1][Minor] Minor optimizations for update_from_output ( vllm-project#12454 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Bugfix] Fix gpt2 GGUF inference ( vllm-project#12467 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [Build] Only build 9.0a for scaled_mm and sparse kernels ( vllm-project#12339 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* [V1][Metrics] Add initial Prometheus logger ( vllm-project#12416 )\n\nSigned-off-by: Mark McLoughlin <markmc@redhat.com>\n\n* [V1][CI/Test] Do basic test for top-p & top-k sampling ( vllm-project#12469 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [FlashInfer] Upgrade to 0.2.0 ( vllm-project#11194 )\n\nSigned-off-by: Bowen Wang <abmfy@icloud.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\n\n* Support FP8 FA from Quark format ( #388 )\n\n* Support FP8 FA from Quark format\n\n* Support FP8 FA from Quark format\n\n* nit: update comment\n\n* Direct call on ROCm\n\n* 20250127 docs update ( #392 )\n\n* updating code blocks\n\n* typo\n\n* updated manifest\n\n* Including feedback\n\n* whitespace\n\n* Deepseek instructions\n\n* hyperlink fix\n\n* hyperlink fix\n\n* updating what is new\n\n* cpx update\n\n* typo\n\n* whitespace\n\n* whitespace\n\n* Faster Custom Paged Attention kernels ( #372 )\n\n* integrate new cpa kernel, update tests and benchmark\n\n* added comments to mfma4 kernel\n\n* further comments for mfma16 kernel\n\n* clang-format\n\n* Lint\n\n* add flag for logits rtz conversion and disable by default\n\n* lint\n\n* [Bugfix]: Fix paged attention unit tests of #372 ( #389 )\n\n* [Bugfix]: fix paged attention tests based on the updated kernels in `csrc/attention/paged_attention_v1.cu`,`csrc/attention/paged_attention_v2.cu` and  `csrc/rocm/attention.cu`.\n\n* improve code documentation.\n\n* lint\n\n---------\n\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\nCo-authored-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: Joe Shajrawi <17753158+shajrawi@users.noreply.github.com>\nCo-authored-by: TJian <tunjian1996@gmail.com>\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n* Using a more precise profiling on ROCm to properly account for weights padding ( #394 )\n\n* Update Dockerfile.rocm\n\n* [Bugfix]: inclucde the env variables required for running FastSyncLLM\n\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n* fix pre-commit lint\n\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n* [Bugfix] included missing environment variable\n\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n---------\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\nSigned-off-by: Akshat Tripathi <akshat@krai.ai>\nSigned-off-by: Oleg Mosalov <oleg@krai.ai>\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\nSigned-off-by: rshaw@neuralmagic.com <rshaw@neuralmagic.com>\nSigned-off-by: Sungjae Lee <33976427+llsj14@users.noreply.github.com>\nSigned-off-by: Yida Wu <yidawu@alumni.cmu.edu>\nSigned-off-by: Chenguang Li <757486878@qq.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nSigned-off-by: Alex-Brooks <Alex.brooks@ibm.com>\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nSigned-off-by: Shanshan Shen <467638484@qq.com>\nSigned-off-by: elijah <f1renze.142857@gmail.com>\nSigned-off-by: Yikun <yikunkero@gmail.com>\nSigned-off-by: mgoin <michael@neuralmagic.com>\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\nSigned-off-by: tjtanaa <tunjian.tan@embeddedllm.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nSigned-off-by: yisheng <yi.sheng@intel.com>\nSigned-off-by: Abatom <abzhonghua@gmail.com>\nSigned-off-by: Liangfu Chen <liangfc@amazon.com>\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\nSigned-off-by: Yuan Zhou <yuan.zhou@intel.com>\nSigned-off-by: Sourashis Roy <sroy@roblox.com>\nSigned-off-by: Nishidha Panpaliya <nishidha.panpaliya@partner.ibm.com>\nSigned-off-by: Ilya Lavrenov <ilya.lavrenov@intel.com>\nSigned-off-by: simon-mo <simon.mo@hey.com>\nSigned-off-by: Wallas Santos <wallashss@ibm.com>\nSigned-off-by: jiang1.li <jiang1.li@intel.com>\nSigned-off-by: yan ma <yan.ma@intel.com>\nSigned-off-by: Randall Smith <Randall.Smith@amd.com>\nSigned-off-by: Max de Bayser <mbayser@br.ibm.com>\nSigned-off-by: Maxime Fournioux <55544262+mfournioux@users.noreply.github.com>\nSigned-off-by: Ye Qi <yeq@meta.com>\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\nSigned-off-by: Joe Runde <Joseph.Runde@ibm.com>\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\nSigned-off-by: Kuntai Du <kuntai@uchicago.edu>\nSigned-off-by: Ren MinMin <renmm6@chinaunicom.cn>\nSigned-off-by: Travis Johnson <tsjohnso@us.ibm.com>\nSigned-off-by: Fred Reiss <frreiss@us.ibm.com>\nSigned-off-by: shaochangxu.scx <shaochangxu.scx@antgroup.com>\nSigned-off-by: NickLucche <nlucches@redhat.com>\nSigned-off-by: Rafael Vasquez <rafvasq21@gmail.com>\nSigned-off-by: Rui Qiao <ruisearch42@gmail.com>\nSigned-off-by: Kyle Sayers <kylesayrs@gmail.com>\nSigned-off-by: Rahul Tuli <rahul@neuralmagic.com>\nSigned-off-by: kewang-xlnx <kewang@xilinx.com>\nSigned-off-by: kewang2 <kewang2@amd.com>\nSigned-off-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nSigned-off-by: hongxyan <hongxyan@amd.com>\nSigned-off-by: Michal Adamczyk <madamczyk@habana.ai>\nSigned-off-by: zibai <zibai.gj@alibaba-inc.com>\nSigned-off-by: Martin Gleize <mgleize@meta.com>\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\nSigned-off-by: isikhi <huseyin.isik000@gmail.com>\nSigned-off-by: Jason Cheng <jasoncky96@gmail.com>\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\nSigned-off-by: Thomas Parnell <tpa@zurich.ibm.com>\nSigned-off-by: Jannis Sch√∂nleber <joennlae@gmail.com>\nSigned-off-by: rickyx <rickyx@anyscale.com>\nSigned-off-by: Andy Lo <andy@mistral.ai>\nSigned-off-by: Adrian Cole <adrian.cole@elastic.co>\nSigned-off-by: maleksan85 <maleksan@amd.com>\nSigned-off-by: Hongxia Yang <hongxyan@amd.com>\nSigned-off-by: kevin <kevin@anyscale.com>\nSigned-off-by: Nick Hill <nhill@redhat.com>\nSigned-off-by: xffxff <1247714429@qq.com>\nSigned-off-by: wangerxiao <863579016@qq.com>\nSigned-off-by: Alexei V. Ivanov <alexei.ivanov@amd.com>\nSigned-off-by: zhenwei <zhenweiliu@habana.ai>\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\nSigned-off-by: ElizaWszola <eliza@neuralmagic.com>\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\nSigned-off-by: Omer Dayan (SW-GPU) <omer@run.ai>\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com>\nSigned-off-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\nSigned-off-by: Kyle Mistele <kyle@mistele.com>\nSigned-off-by: Pooya Davoodi <pooya.davoodi@parasail.io>\nSigned-off-by: Mark McLoughlin <markmc@redhat.com>\nSigned-off-by: Bowen Wang <abmfy@icloud.com>\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\nCo-authored-by: Isotr0py <mozf@mail2.sysu.edu.cn>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\nCo-authored-by: Akshat Tripathi <Akshat.tripathi6568@gmail.com>\nCo-authored-by: Oleg Mosalov <oleg@krai.ai>\nCo-authored-by: Jee Jee Li <pandaleefree@gmail.com>\nCo-authored-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Avshalom Manevich <12231371+avshalomman@users.noreply.github.com>\nCo-authored-by: Robert Shaw <114415538+robertgshaw2-neuralmagic@users.noreply.github.com>\nCo-authored-by: Yangcheng Li <liyangcheng.lyc@alibaba-inc.com>\nCo-authored-by: Siyuan Li <94890248+liaoyanqing666@users.noreply.github.com>\nCo-authored-by: Sungjae Lee <33976427+llsj14@users.noreply.github.com>\nCo-authored-by: Concurrensee <yida.wu@amd.com>\nCo-authored-by: Chenguang Li <757486878@qq.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Alex Brooks <alex.brooks@ibm.com>\nCo-authored-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: Roger Wang <136131678+ywang96@users.noreply.github.com>\nCo-authored-by: Cyrus Leung <tlleungac@connect.ust.hk>\nCo-authored-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nCo-authored-by: Shanshan Shen <467638484@qq.com>\nCo-authored-by: elijah <30852919+e1ijah1@users.noreply.github.com>\nCo-authored-by: Yikun Jiang <yikunkero@gmail.com>\nCo-authored-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: Steve Luo <36296769+SunflowerAries@users.noreply.github.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: Alexei-V-Ivanov-AMD <156011006+Alexei-V-Ivanov-AMD@users.noreply.github.com>\nCo-authored-by: Alexei V. Ivanov <alivanov@banff-cyxtera-s65-4.amd.com>\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\nCo-authored-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\nCo-authored-by: Konrad Zawora <kzawora@habana.ai>\nCo-authored-by: wangxiyuan <wangxiyuan1007@gmail.com>\nCo-authored-by: maang-h <55082429+maang-h@users.noreply.github.com>\nCo-authored-by: YiSheng5 <yi.sheng@intel.com>\nCo-authored-by: Zhonghua Deng <abatom@163.com>\nCo-authored-by: Liangfu Chen <liangfc@amazon.com>\nCo-authored-by: XiaobingZhang <xiaobingzhangupc@gmail.com>\nCo-authored-by: Russell Bryant <rbryant@redhat.com>\nCo-authored-by: Yuan <yuan.zhou@intel.com>\nCo-authored-by: jiangjiadi <34134495+jiangjiadi@users.noreply.github.com>\nCo-authored-by: jiadi.jjd <jiadi.jjd@antgroup.com>\nCo-authored-by: sroy745 <142070531+sroy745@users.noreply.github.com>\nCo-authored-by: Jie Fu (ÂÇÖÊù∞) <jiefu@tencent.com>\nCo-authored-by: Divakar Verma <137818590+divakar-amd@users.noreply.github.com>\nCo-authored-by: WangErXiao <863579016@qq.com>\nCo-authored-by: Nishidha <nishidha.panpaliya@partner.ibm.com>\nCo-authored-by: Ilya Lavrenov <ilya.lavrenov@intel.com>\nCo-authored-by: Simon Mo <simon.mo@hey.com>\nCo-authored-by: Wallas Henrique <wallashss@users.noreply.github.com>\nCo-authored-by: Li, Jiang <jiang1.li@intel.com>\nCo-authored-by: Yan Ma <yan.ma@intel.com>\nCo-authored-by: rasmith <Randall.Smith@amd.com>\nCo-authored-by: Tyler Michael Smith <tyler@neuralmagic.com>\nCo-authored-by: Maximilien de Bayser <mbayser@br.ibm.com>\nCo-authored-by: Maxime Fournioux <55544262+mfournioux@users.noreply.github.com>\nCo-authored-by: Guspan Tanadi <36249910+guspan-tanadi@users.noreply.github.com>\nCo-authored-by: Ye (Charlotte) Qi <ye.charlotte.qi@gmail.com>\nCo-authored-by: yeq <yeq@devgpu004.lla3.facebook.com>\nCo-authored-by: Mengqing Cao <cmq0113@163.com>\nCo-authored-by: Charles Frye <cfrye59@gmail.com>\nCo-authored-by: Joe Runde <Joseph.Runde@ibm.com>\nCo-authored-by: Kunshang Ji <kunshang.ji@intel.com>\nCo-authored-by: cennn <61925104+cennn@users.noreply.github.com>\nCo-authored-by: Kuntai Du <kuntai@uchicago.edu>\nCo-authored-by: minmin <rmm0811@gmail.com>\nCo-authored-by: Ren MinMin <renmm6@chinaunicom.cn>\nCo-authored-by: Travis Johnson <tsjohnso@us.ibm.com>\nCo-authored-by: Fred Reiss <frreiss@us.ibm.com>\nCo-authored-by: shaochangxu <85155497+shaochangxu@users.noreply.github.com>\nCo-authored-by: shaochangxu.scx <shaochangxu.scx@antgroup.com>\nCo-authored-by: Nicol√≤ Lucchesi <nlucches@redhat.com>\nCo-authored-by: sixgod <evethwillbeok@outlook.com>\nCo-authored-by: Rafael Vasquez <rafvasq21@gmail.com>\nCo-authored-by: Elfie Guo <164945471+elfiegg@users.noreply.github.com>\nCo-authored-by: Rui Qiao <161574667+ruisearch42@users.noreply.github.com>\nCo-authored-by: Kyle Sayers <kylesayrs@gmail.com>\nCo-authored-by: Rahul Tuli <rahul@neuralmagic.com>\nCo-authored-by: Keyun Tong <tongkeyun@gmail.com>\nCo-authored-by: RunningLeon <maningsheng@sensetime.com>\nCo-authored-by: kewang-xlnx <73578509+kewang-xlnx@users.noreply.github.com>\nCo-authored-by: kewang2 <kewang2@amd.com>\nCo-authored-by: Varun Sundar Rabindranath <varunsundar08@gmail.com>\nCo-authored-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nCo-authored-by: tvirolai-amd <teemu.virolainen@amd.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: Zhaoyi Li <36555117+Lzy17@users.noreply.github.com>\nCo-authored-by: charlifu <charlifu@amd.com>\nCo-authored-by: Yuan Tang <terrytangyuan@gmail.com>\nCo-authored-by: Cody Yu <hao.yu.cody@gmail.com>\nCo-authored-by: Hongxia Yang <62075498+hongxiayang@users.noreply.github.com>\nCo-authored-by: yancong <32220263+ice-tong@users.noreply.github.com>\nCo-authored-by: Michal Adamczyk <madamczyk@habana.ai>\nCo-authored-by: gujing <925973396@qq.com>\nCo-authored-by: imkero <kerorek@outlook.com>\nCo-authored-by: Martin Gleize <mgleize@meta.com>\nCo-authored-by: mgleize user <mgleize@a100-st-p4de24xlarge-4.fair-a100.hpcaas>\nCo-authored-by: shangmingc <caishangming@linux.alibaba.com>\nCo-authored-by: I≈üƒ±k <41375111+isikhi@users.noreply.github.com>\nCo-authored-by: Roger Wang <ywang@roblox.com>\nCo-authored-by: Cheng Kuan Yong Jason <jasoncky96@gmail.com>\nCo-authored-by: Jinzhen Lin <linjinzhen@hotmail.com>\nCo-authored-by: Thomas Parnell <tpa@zurich.ibm.com>\nCo-authored-by: Jannis Sch√∂nleber <joennlae@gmail.com>\nCo-authored-by: Ricky Xu <xuchen727@hotmail.com>\nCo-authored-by: Andy Lo <andylolu24@gmail.com>\nCo-authored-by: Adrian Cole <64215+codefromthecrypt@users.noreply.github.com>\nCo-authored-by: Jani Monoses <jani.monoses@gmail.com>\nCo-authored-by: Kevin H. Luu <kevin@anyscale.com>\nCo-authored-by: Aleksandr Malyshev <164964928+maleksan85@users.noreply.github.com>\nCo-authored-by: maleksan85 <maleksan@amd.com>\nCo-authored-by: Nick Hill <nickhill@us.ibm.com>\nCo-authored-by: zhou fan <1247714429@qq.com>\nCo-authored-by: ilia-cher <30845429+ilia-cher@users.noreply.github.com>\nCo-authored-by: liuzhenwei <zhenweiliu@habana.ai>\nCo-authored-by: Lucas Wilkinson <LucasWilkinson@users.noreply.github.com>\nCo-authored-by: Micah Williamson <micah.williamson@amd.com>\nCo-authored-by: Siyuan Liu <lsiyuan@google.com>\nCo-authored-by: Dipika Sikka <dipikasikka1@gmail.com>\nCo-authored-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\nCo-authored-by: Robert Shaw <rshaw@neuralmagic.com>\nCo-authored-by: omer-dayan <omer@run.ai>\nCo-authored-by: Mohit Deopujari <mdeopujari@habana.ai>\nCo-authored-by: Jeremy Arnold <103538711+JArnoldAMD@users.noreply.github.com>\nCo-authored-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nCo-authored-by: Kyle Mistele <kyle@mistele.com>\nCo-authored-by: Pooya Davoodi <pooya.davoodi@parasail.io>\nCo-authored-by: Mark McLoughlin <markmc@redhat.com>\nCo-authored-by: Bowen Wang <abmfy@icloud.com>\nCo-authored-by: Bowen Bao <bowenbao@amd.com>\nCo-authored-by: arakowsk-amd <182798202+arakowsk-amd@users.noreply.github.com>\nCo-authored-by: sanyalington <shomy.sanyal@amd.com>\nCo-authored-by: Joe Shajrawi <17753158+shajrawi@users.noreply.github.com>\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com> NickLucche pushed a commit\n        to NickLucche/vllm\n      that referenced\n      this pull request Feb 7, 2025 [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( ‚Ä¶ ‚Ä¶ 42bfed0 ‚Ä¶vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com> GWS0428 pushed a commit\n        to GWS0428/VARserve\n      that referenced\n      this pull request Feb 12, 2025 [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( ‚Ä¶ ‚Ä¶ 75d4b32 ‚Ä¶vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com> hongxiayang added a commit\n        to ROCm/vllm\n      that referenced\n      this pull request Feb 19, 2025 [FEAT] [AITER] Support AITER operators: Fused MoE, Linear, Norm ( #436 ) ‚Ä¶ 4c8c86d * [Doc] Update Quantization Hardware Support Documentation ( vllm-project#12025 )\n\nSigned-off-by: tjtanaa <tunjian.tan@embeddedllm.com>\nCo-authored-by: tjtanaa <tunjian.tan@embeddedllm.com>\n\n* [HPU][misc] add comments for explanation ( vllm-project#12034 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix various bugs in multi-modal processor ( vllm-project#12031 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Kernel] Revert the API change of Attention.forward ( vllm-project#12038 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Platform] Add output for Attention Backend ( vllm-project#11981 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix][Kernel] Give unique name to BlockSparseFlashAttention ( vllm-project#12040 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* Explain where the engine args go when using Docker ( vllm-project#12041 )\n\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\n\n* Docs lint\n\n* [Doc]: Update the Json Example of the `Engine Arguments` document ( vllm-project#12045 )\n\n* [Misc]  Merge bitsandbytes_stacked_params_mapping and packed_modules_mapping ( vllm-project#11924 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [Kernel] Support MulAndSilu ( vllm-project#11624 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [HPU][Bugfix] Don't use /dev/accel/accel0 for HPU autodetection in setup.py ( vllm-project#12046 )\n\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\n\n* [Platform] move current_memory_usage() into platform ( vllm-project#11369 )\n\nSigned-off-by: Shanshan Shen <467638484@qq.com>\n\n* [V1][BugFix] Fix edge case in VLM scheduling ( vllm-project#12065 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Misc] Add multipstep chunked-prefill support for FlashInfer ( vllm-project#10467 )\n\n* [core] Turn off GPU communication overlap for Ray executor ( vllm-project#12051 )\n\nSigned-off-by: Rui Qiao <ruisearch42@gmail.com>\n\n* [core] platform agnostic executor via collective_rpc ( vllm-project#11256 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Doc] Update examples to remove SparseAutoModelForCausalLM ( vllm-project#12062 )\n\nSigned-off-by: Kyle Sayers <kylesayrs@gmail.com>\n\n* [V1][Prefix Cache] Move the logic of num_computed_tokens into KVCacheManager ( vllm-project#12003 )\n\n* Fix: cases with empty sparsity config ( vllm-project#12057 )\n\nSigned-off-by: Rahul Tuli <rahul@neuralmagic.com>\n\n* Type-fix: make execute_model output type optional ( vllm-project#12020 )\n\n* [Platform] Do not raise error if _Backend is not found ( vllm-project#12023 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\nCo-authored-by: Mengqing Cao <cmq0113@163.com>\n\n* [Model]: Support internlm3 ( vllm-project#12037 )\n\n* Misc: allow to use proxy in `HTTPConnection` ( vllm-project#12042 )\n\nSigned-off-by: Yuan Zhou <yuan.zhou@intel.com>\n\n* [Misc][Quark] Upstream Quark format to VLLM ( vllm-project#10765 )\n\nSigned-off-by: kewang-xlnx <kewang@xilinx.com>\nSigned-off-by: kewang2 <kewang2@amd.com>\nCo-authored-by: kewang2 <kewang2@amd.com>\nCo-authored-by: Michael Goin <michael@neuralmagic.com>\n\n* [Doc]: Update `OpenAI-Compatible Server` documents ( vllm-project#12082 )\n\n* [Bugfix] use right truncation for non-generative tasks ( vllm-project#12050 )\n\nSigned-off-by: Joe Runde <Joseph.Runde@ibm.com>\n\n* [V1][Core] Autotune encoder cache budget ( vllm-project#11895 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [Bugfix] Fix _get_lora_device for HQQ marlin ( vllm-project#12090 )\n\nSigned-off-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nCo-authored-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\n\n* Allow hip sources to be directly included when compiling for rocm. ( vllm-project#12087 )\n\n* [Core] Default to using per_token quantization for fp8 when cutlass is supported. ( vllm-project#8651 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\n\n* [Doc] Add documentation for specifying model architecture ( vllm-project#12105 )\n\n* Various cosmetic/comment fixes ( vllm-project#12089 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\n\n* [Bugfix] Remove hardcoded `head_size=256` for Deepseek v2 and v3 ( vllm-project#12067 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* Support torchrun and SPMD-style offline inference ( vllm-project#12071 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [core] LLM.collective_rpc interface and RLHF example ( vllm-project#12084 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix max image feature size for Llava-one-vision ( vllm-project#12104 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* Enable user marker for vllm profiling ( #357 )\n\n* Enable user marker for vllm profiling\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\n\n* [misc] Add LoRA kernel micro benchmarks ( vllm-project#11579 )\n\n* [Model] Add support for deepseek-vl2-tiny model ( vllm-project#12068 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* Deepseek V3 support ( #364 )\n\n* Changing the hard coded datatype to see if it's enough for the model to work\n\n* Picking the upstrteam moe kernel version\n\n* make upstream fix for v3 also works for rocm v2\n\n* Conditional fnuz dtype\n\n* Requantizing from fn to fnuz\n\n* Requantizing moe as well\n\n* Actually requantizing moe weights\n\n* Conditional requantization and assert on padding in block quant\n\n* Format\n\n---------\n\nCo-authored-by: charlifu <charlifu@amd.com>\n\n* [Bugfix] Set enforce_eager automatically for mllama ( vllm-project#12127 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Bugfix] Fix a path bug in disaggregated prefill example script. ( vllm-project#12121 )\n\nSigned-off-by: Kuntai Du <kuntai@uchicago.edu>\n\n* [CI]add genai-perf benchmark in nightly benchmark ( vllm-project#10704 )\n\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\n\n* [Doc] Add instructions on using Podman when SELinux is active ( vllm-project#12136 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Bugfix] Fix issues in CPU build Dockerfile ( vllm-project#12135 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [BugFix] add more `is not None` check in VllmConfig.__post_init__ ( vllm-project#12138 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Misc] Add deepseek_vl2 chat template ( vllm-project#12143 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [ROCm][MoE] moe tuning support for rocm ( vllm-project#12049 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [V1] Move more control of kv cache initialization from model_executor to EngineCore ( vllm-project#11960 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: Cody Yu <hao.yu.cody@gmail.com>\n\n* [Misc][LoRA] Improve the readability of LoRA error messages ( vllm-project#12102 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [CI/Build][CPU][Bugfix] Fix CPU CI ( vllm-project#12150 )\n\nSigned-off-by: jiang1.li <jiang1.li@intel.com>\n\n* [core] allow callable in collective_rpc ( vllm-project#12151 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] Fix score api for missing max_model_len validation ( vllm-project#12119 )\n\nSigned-off-by: Wallas Santos <wallashss@ibm.com>\n\n* [Bugfix] Mistral tokenizer encode accept list of str ( vllm-project#12149 )\n\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\n\n* [AMD][FP8] Using MI300 FP8 format on ROCm for block_quant ( vllm-project#12134 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\n\n* [torch.compile] disable logging when cache is disabled ( vllm-project#12043 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [misc] fix cross-node TP ( vllm-project#12166 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [AMD][CI/Build][Bugfix] use pytorch stale wheel ( vllm-project#12172 )\n\nSigned-off-by: hongxyan <hongxyan@amd.com>\n\n* [core] further polish memory profiling ( vllm-project#12126 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Docs] Fix broken link in SECURITY.md ( vllm-project#12175 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [Model] Port deepseek-vl2 processor, remove dependency ( vllm-project#12169 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [core] clean up executor class hierarchy between v1 and v0 ( vllm-project#12171 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Support register quantization method out-of-tree ( vllm-project#11969 )\n\n* [V1] Collect env var for usage stats ( vllm-project#12115 )\n\n* [BUGFIX] Move scores to float32 in case of running xgrammar on cpu ( vllm-project#12152 )\n\nSigned-off-by: Michal Adamczyk <madamczyk@habana.ai>\n\n* [Bugfix] Fix multi-modal processors for transformers 4.48 ( vllm-project#12187 )\n\n* [torch.compile] store inductor compiled Python file ( vllm-project#12182 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* benchmark_serving support --served-model-name param ( vllm-project#12109 )\n\nSigned-off-by: zibai <zibai.gj@alibaba-inc.com>\nCo-authored-by: Roger Wang <136131678+ywang96@users.noreply.github.com>\n\n* [Misc] Add BNB support to GLM4-V model ( vllm-project#12184 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [V1] Add V1 support of Qwen2-VL ( vllm-project#12128 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nCo-authored-by: imkero <kerorek@outlook.com>\nCo-authored-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model] Support for fairseq2 Llama ( vllm-project#11442 )\n\nSigned-off-by: Martin Gleize <mgleize@meta.com>\nCo-authored-by: mgleize user <mgleize@a100-st-p4de24xlarge-4.fair-a100.hpcaas>\n\n* [Bugfix] Fix num_heads value for simple connector when tp enabled ( vllm-project#12074 )\n\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\n\n* [torch.compile] fix sym_tensor_indices ( vllm-project#12191 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* Move linting to `pre-commit` ( vllm-project#11975 )\n\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\n\n* [DOC] Fix typo in docstring and assert message ( vllm-project#12194 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [DOC] Add missing docstring in LLMEngine.add_request() ( vllm-project#12195 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Bugfix] Fix incorrect types in LayerwiseProfileResults ( vllm-project#12196 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [Model] Add Qwen2 PRM model support ( vllm-project#12202 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [Core] Interface for accessing model from `VllmRunner` ( vllm-project#10353 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [misc] add placeholder format.sh ( vllm-project#12206 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [CI/Build] Remove dummy CI steps ( vllm-project#12208 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [CI/Build] Make pre-commit faster ( vllm-project#12212 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model] Upgrade Aria to transformers 4.48 ( vllm-project#12203 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [misc] print a message to suggest how to bypass commit hooks ( vllm-project#12217 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [core][bugfix] configure env var during import vllm ( vllm-project#12209 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [V1] Remove `_get_cache_block_size` ( vllm-project#12214 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* [Misc] Pass `attention` to impl backend ( vllm-project#12218 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix] Fix `HfExampleModels.find_hf_info` ( vllm-project#12223 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [CI] Pass local python version explicitly to pre-commit mypy.sh ( vllm-project#12224 )\n\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\n\n* Using ROCm6.3.1 base docker and building hipblas-common ( #366 )\n\n* [Misc] Update CODEOWNERS ( vllm-project#12229 )\n\n* fix: update platform detection for M-series arm based MacBook processors ( vllm-project#12227 )\n\nSigned-off-by: isikhi <huseyin.isik000@gmail.com>\n\n* [misc] add cuda runtime version to usage data ( vllm-project#12190 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Roger Wang <ywang@roblox.com>\n\n* [bugfix] catch xgrammar unsupported array constraints ( vllm-project#12210 )\n\nSigned-off-by: Jason Cheng <jasoncky96@gmail.com>\n\n* [Kernel] optimize moe_align_block_size for cuda graph and large num_experts (e.g. DeepSeek-V3) ( vllm-project#12222 )\n\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: Tyler Michael Smith <tyler@neuralmagic.com>\n\n* Add quantization and guided decoding CODEOWNERS ( vllm-project#12228 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\n\n* [AMD][Build] Porting dockerfiles from the ROCm/vllm fork ( vllm-project#11777 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\n\n* [BugFix] Fix GGUF tp>1 when vocab_size is not divisible by 64 ( vllm-project#12230 )\n\nSigned-off-by: NickLucche <nlucches@redhat.com>\n\n* [ci/build] disable failed and flaky tests ( vllm-project#12240 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Rename `MultiModalInputsV2 -> MultiModalInputs` ( vllm-project#12244 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Misc]Add BNB quantization for PaliGemmaForConditionalGeneration  ( vllm-project#12237 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* [Misc] Remove redundant TypeVar from base model ( vllm-project#12248 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix] Fix mm_limits access for merged multi-modal processor ( vllm-project#12252 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [torch.compile] transparent compilation with more logging ( vllm-project#12246 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [V1][Bugfix] Fix data item ordering in mixed-modality inference ( vllm-project#12259 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* Remove pytorch comments for outlines + compressed-tensors ( vllm-project#12260 )\n\nSigned-off-by: Thomas Parnell <tpa@zurich.ibm.com>\n\n* [Platform] improve platforms getattr ( vllm-project#12264 )\n\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\n\n* [ci/build] update nightly torch for gh200 test ( vllm-project#12270 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Bugfix] fix race condition that leads to wrong order of token returned ( vllm-project#10802 )\n\nSigned-off-by: Jannis Sch√∂nleber <joennlae@gmail.com>\n\n* [Kernel] fix moe_align_block_size error condition ( vllm-project#12239 )\n\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\n\n* [v1][stats][1/n] Add RequestStatsUpdate and RequestStats types  ( vllm-project#10907 )\n\nSigned-off-by: rickyx <rickyx@anyscale.com>\n\n* [Bugfix] Multi-sequence broken ( vllm-project#11898 )\n\nSigned-off-by: Andy Lo <andy@mistral.ai>\n\n* [Misc] Remove experimental dep from tracing.py ( vllm-project#12007 )\n\nSigned-off-by: Adrian Cole <adrian.cole@elastic.co>\n\n* [Misc] Set default backend to SDPA for get_vit_attn_backend ( vllm-project#12235 )\n\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Core] Free CPU pinned memory on environment cleanup ( vllm-project#10477 )\n\n* Update pre-commit.yml ( #374 )\n\n* Update pre-commit.yml\n\n* Reapplying missing format\n\n* New codespell exclude location\n\n---------\n\nCo-authored-by: Kevin H. Luu <kevin@anyscale.com>\n\n* [bugfix] moe tuning. rm is_navi() ( vllm-project#12273 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [BUGFIX] When skip_tokenize_init and multistep are set, execution crashes ( vllm-project#12277 )\n\nSigned-off-by: maleksan85 <maleksan@amd.com>\nCo-authored-by: maleksan85 <maleksan@amd.com>\n\n* [Documentation][AMD] Add information about prebuilt ROCm vLLM docker for perf validation purpose ( vllm-project#12281 )\n\nSigned-off-by: Hongxia Yang <hongxyan@amd.com>\n\n* [VLM] Simplify post-processing of replacement info ( vllm-project#12269 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [ci/lint] Add back default arg for pre-commit ( vllm-project#12279 )\n\nSigned-off-by: kevin <kevin@anyscale.com>\n\n* [CI] add docker volume prune to neuron CI ( vllm-project#12291 )\n\nSigned-off-by: Liangfu Chen <liangfc@amazon.com>\n\n* [Ci/Build] Fix mypy errors on main ( vllm-project#12296 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Benchmark] More accurate TPOT calc in `benchmark_serving.py` ( vllm-project#12288 )\n\nSigned-off-by: Nick Hill <nhill@redhat.com>\n\n* [core] separate builder init and builder prepare for each batch ( vllm-project#12253 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Build] update requirements of no-device ( vllm-project#12299 )\n\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\n\n* [Core] Support fully transparent sleep mode ( vllm-project#11743 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [VLM] Avoid unnecessary tokenization ( vllm-project#12310 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Model][Bugfix]: correct Aria model output ( vllm-project#12309 )\n\nSigned-off-by: xffxff <1247714429@qq.com>\n\n* [Bugfix][VLM] Fix mixed-modality inference backward compatibility for V0 ( vllm-project#12313 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [Doc] Add docs for prompt replacement ( vllm-project#12318 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Misc] Fix the error in the tip for the --lora-modules parameter ( vllm-project#12319 )\n\nSigned-off-by: wangerxiao <863579016@qq.com>\n\n* [Misc]  Improve the readability of BNB error messages  ( vllm-project#12320 )\n\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\n\n* Skip tokenize/detokenize when it is disabled by arg --skip-tokenizer-init ( #367 )\n\n* switching detokenize flag to be False\n\n* detokenize = False for benchmarks\n\n* restoring default in main vllm code for detokenize\n\n* removing extra spaces\n\n* moving detokenize to flag\n\n* adding support for token ids\n\n---------\n\nCo-authored-by: maleksan85 <maleksan@amd.com>\n\n* [Bugfix] Fix HPU multiprocessing executor ( vllm-project#12167 )\n\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\n\n* [Core] Support `reset_prefix_cache` ( vllm-project#12284 )\n\n* [Frontend][V1] Online serving performance improvements ( vllm-project#12287 )\n\n* [AMD][Quantization] Add TritonScaledMMLinearKernel since int8 is broken for AMD ( vllm-project#12282 )\n\nSigned-off-by: Randall Smith <Randall.Smith@amd.com>\n\n* FP8 FA fixes ( #381 )\n\n* FP8 FA fixes\n\nSummary:\nAdd missing clamp and fix reciprocal scale computation.\n\n* linter\n\n* Returning the use of the proper stream in allreduce ( #382 )\n\n* [Bugfix] Fixing  AMD LoRA CI test. ( vllm-project#12329 )\n\nSigned-off-by: Alexei V. Ivanov <alexei.ivanov@amd.com>\n\n* [Docs] Update FP8 KV Cache documentation ( vllm-project#12238 )\n\nSigned-off-by: mgoin <michael@neuralmagic.com>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\n\n* [Docs] Document vulnerability disclosure process ( vllm-project#12326 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [V1] Add `uncache_blocks` ( vllm-project#12333 )\n\n* [doc] explain common errors around torch.compile ( vllm-project#12340 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Hardware][Gaudi][BugFix] Fix dataclass error due to triton package update ( vllm-project#12338 )\n\nSigned-off-by: zhenwei <zhenweiliu@habana.ai>\n\n* [Bugfix] Fix k_proj's bias for whisper self attention ( vllm-project#12342 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [Kernel] Flash Attention 3 Support ( vllm-project#12093 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* [Doc] Troubleshooting errors during model inspection ( vllm-project#12351 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [V1] Simplify M-RoPE ( vllm-project#12352 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nCo-authored-by: imkero <kerorek@outlook.com>\n\n* [Bugfix] Fix broken internvl2 inference with v1 ( vllm-project#12360 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [core] add wake_up doc and some sanity check ( vllm-project#12361 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [torch.compile] decouple compile sizes and cudagraph sizes ( vllm-project#12243 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [FP8][Kernel] Dynamic kv cache scaling factors computation ( vllm-project#11906 )\n\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: Micah Williamson <micah.williamson@amd.com>\n\n* [TPU] Update TPU CI to use torchxla nightly on 20250122 ( vllm-project#12334 )\n\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\n\n* [Docs] Document Phi-4 support ( vllm-project#12362 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [BugFix] Fix parameter names and `process_after_weight_loading` for W4A16 MoE Group Act Order  ( vllm-project#11528 )\n\nSigned-off-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: Michael Goin <michael@neuralmagic.com>\n\n* [Misc] Fix OpenAI API Compatibility Issues in Benchmark Script ( vllm-project#12357 )\n\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\n\n* [Docs] Add meetup slides ( vllm-project#12345 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* Using pytorch commit past the point when rowwise PR ( pytorch/pytorch#144432 ) was merged ( #384 )\n\n* Integrated ater: kvcache pa gemm rmsnorm\n\n* fix pa\n\n* fix\n\n* replace topk softmax\n\n* [Docs] Update spec decode + structured output in compat matrix ( vllm-project#12373 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* replace fp moe kernel with aiter kernel\n\n* [V1][Frontend] Coalesce bunched `RequestOutput`s ( vllm-project#12298 )\n\nSigned-off-by: Nick Hill <nhill@redhat.com>\nCo-authored-by: Robert Shaw <rshaw@neuralmagic.com>\n\n* Set weights_only=True when using torch.load() ( vllm-project#12366 )\n\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\n\n* [Bugfix] Path join when building local path for S3 clone ( vllm-project#12353 )\n\nSigned-off-by: Omer Dayan (SW-GPU) <omer@run.ai>\n\n* change ater to aiter\n\n* Update compressed-tensors version ( vllm-project#12367 )\n\n* [V1] Increase default batch size for H100/H200 ( vllm-project#12369 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [perf] fix perf regression from vllm-project#12253 ( vllm-project#12380 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Use VisionArena Dataset for VLM Benchmarking ( vllm-project#12389 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* [ci/build] fix wheel size check ( vllm-project#12396 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Hardware][Gaudi][Doc] Add missing step in setup instructions ( vllm-project#12382 )\n\n* [ci/build] sync default value for wheel size ( vllm-project#12398 )\n\nSigned-off-by: youkaichao <youkaichao@gmail.com>\n\n* [Misc] Enable proxy support in benchmark script ( vllm-project#12356 )\n\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\n\n* [Bugfix][Kernel] Fix CUDA 11.8 being broken by FA3 build ( vllm-project#12375 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* Applying scales rename to fp8 config\n\n* Applying scales rename to fp8 config ( #387 )\n\n* Update Dockerfile.rocm\n\n* [Misc] Remove deprecated code ( vllm-project#12383 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix][Kernel] FA3 Fix - RuntimeError: This flash attention build only supports pack_gqa (for build size reasons). ( vllm-project#12405 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* Using aiter moe kernel\n\n* Dev-docker Documentation Updates ( #378 )\n\n* Dev-docker Documentation Updates\n\nMinor updates to several sections, with links to other documents where appropriate.\n\n* Fix formatting of GEMM filename\n\n* README cleanup\n\n- Reorder some sections of the README to make them easier to follow\n- Improve formatting of bash commands\n- Prefer use of huggingface model names instead of hard-coded directories\n- Clean up wording\n\n* Expanded sample commands for Latency and Throughput\n\n* Fix markdown links\n\n* Fix pre-commit errors\n\n* Updates from review\n\nInitial updates to incorporate feedback from a review session held with @t-parry * Update script args to match current recommendations\n\n* Remove recommended max-num-seqs values for now\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\n\n* [Bugfix][Kernel] Fix moe align block issue for mixtral ( vllm-project#12413 )\n\n* [Bugfix] Fix BLIP-2 processing ( vllm-project#12412 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [ROCm][MoE] MI300 tuned configs Mixtral-8x(7B,22B) | fp16, fp8 ( vllm-project#12408 )\n\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\n\n* [Misc] Add FA2 support to ViT MHA layer ( vllm-project#12355 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [TPU][CI] Update torchxla version in requirement-tpu.txt ( vllm-project#12422 )\n\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\n\n* [Misc][Bugfix] FA3 support to ViT MHA layer ( vllm-project#12435 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Isotr0py <2037008807@qq.com>\n\n* [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com>\n\n* [V1][Bugfix] Fix assertion when mm hashing is turned off ( vllm-project#12439 )\n\nSigned-off-by: Roger Wang <ywang@roblox.com>\n\n* fix pa copy\n\n* pa update\n\n* [Misc] Revert FA on ViT vllm-project#12355 and vllm-project#12435 ( vllm-project#12445 )\n\n* [Frontend] generation_config.json for  maximum tokens( vllm-project#12242 )\n\nSigned-off-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\nSigned-off-by: Isotr0py <2037008807@qq.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nCo-authored-by: shangmingc <caishangming@linux.alibaba.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nCo-authored-by: Yuan Tang <terrytangyuan@gmail.com>\nCo-authored-by: Isotr0py <mozf@mail2.sysu.edu.cn>\nCo-authored-by: Cyrus Leung <tlleungac@connect.ust.hk>\nCo-authored-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: wangxiyuan <wangxiyuan1007@gmail.com>\n\n* [Bugfix] Disable w16a16 2of4 sparse CompressedTensors24 ( vllm-project#12417 )\n\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\nCo-authored-by: mgoin <michael@neuralmagic.com>\n\n* add fp16 pa support for aiter\n\n* [Bugfix/CI] Fix broken kernels/test_mha.py ( vllm-project#12450 )\n\n* [Bugfix][Kernel] Fix perf regression caused by PR vllm-project#12405 ( vllm-project#12434 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* [Build/CI] Fix libcuda.so linkage ( vllm-project#12424 )\n\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\n\n* [Frontend] Rerank API (Jina- and Cohere-compatible API)  ( vllm-project#12376 )\n\nSigned-off-by: Kyle Mistele <kyle@mistele.com>\n\n* [DOC] Add link to vLLM blog ( vllm-project#12460 )\n\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\n\n* [V1] Avoid list creation in input preparation ( vllm-project#12457 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Frontend] Support scores endpoint in run_batch ( vllm-project#12430 )\n\nSigned-off-by: Pooya Davoodi <pooya.davoodi@parasail.io>\n\n* [Bugfix] Fix Granite 3.0 MoE model loading ( vllm-project#12446 )\n\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\n\n* [Bugfix] Fix missing seq_start_loc in xformers prefill metadata ( vllm-project#12464 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* [V1][Minor] Minor optimizations for update_from_output ( vllm-project#12454 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [Bugfix] Fix gpt2 GGUF inference ( vllm-project#12467 )\n\nSigned-off-by: Isotr0py <2037008807@qq.com>\n\n* aiter build instructions\n\n* [Build] Only build 9.0a for scaled_mm and sparse kernels ( vllm-project#12339 )\n\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\n\n* Copy to the right path\n\n* [V1][Metrics] Add initial Prometheus logger ( vllm-project#12416 )\n\nSigned-off-by: Mark McLoughlin <markmc@redhat.com>\n\n* [V1][CI/Test] Do basic test for top-p & top-k sampling ( vllm-project#12469 )\n\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\n\n* [FlashInfer] Upgrade to 0.2.0 ( vllm-project#11194 )\n\nSigned-off-by: Bowen Wang <abmfy@icloud.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\n\n* Support FP8 FA from Quark format ( #388 )\n\n* Support FP8 FA from Quark format\n\n* Support FP8 FA from Quark format\n\n* nit: update comment\n\n* Direct call on ROCm\n\n* 20250127 docs update ( #392 )\n\n* updating code blocks\n\n* typo\n\n* updated manifest\n\n* Including feedback\n\n* whitespace\n\n* Deepseek instructions\n\n* hyperlink fix\n\n* hyperlink fix\n\n* updating what is new\n\n* cpx update\n\n* typo\n\n* whitespace\n\n* whitespace\n\n* Add env var toggles to disable AITER MoE or PA (both by default on)\n\n* Update accuracy benchmark for batch size > 1\n\n* Add a few more AITER toggles for norm and linear layers\n\n* Faster Custom Paged Attention kernels ( #372 )\n\n* integrate new cpa kernel, update tests and benchmark\n\n* added comments to mfma4 kernel\n\n* further comments for mfma16 kernel\n\n* clang-format\n\n* Lint\n\n* add flag for logits rtz conversion and disable by default\n\n* lint\n\n* [Bugfix]: Fix paged attention unit tests of #372 ( #389 )\n\n* [Bugfix]: fix paged attention tests based on the updated kernels in `csrc/attention/paged_attention_v1.cu`,`csrc/attention/paged_attention_v2.cu` and  `csrc/rocm/attention.cu`.\n\n* improve code documentation.\n\n* lint\n\n---------\n\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n---------\n\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\nCo-authored-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: Joe Shajrawi <17753158+shajrawi@users.noreply.github.com>\nCo-authored-by: TJian <tunjian1996@gmail.com>\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n* Using a more precise profiling on ROCm to properly account for weights padding ( #394 )\n\n* Public aiter repo\n\n* Fail if aiter build failed silently\n\n* Aiter can only be built on MI300x\n\n* Typo fix\n\n* Aiter PA off by default\n\n* Changes to support updated aiter FP8 PA\n\n* Support FP8 and INT8 KV cache according to ROCm/aiter#90 * add moe weight shuffle for dynamic quant and unquantized path\n\nSigned-off-by: charlifu <charlifu@amd.com>\n\n* Use FP16-native PA after support in ROCm/aiter#97 * Fix: Use FP8 pertoken quantize if KV cache dtype is FP8\n\n* revert rocm_flash_attn.py line 883\n\n* Don't enable by default to use an RC for main vllm-dev docker\n\n* use ck moe for bf16 and fp16 fused_moe\n\n* Merge remote-tracking branch 'origin/aiter_intergration_final' into merge-aiter-llama-fp8\n\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n* [Bugfix] include moe shuffle env variable\n\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\n\n---------\n\nSigned-off-by: tjtanaa <tunjian.tan@embeddedllm.com>\nSigned-off-by: youkaichao <youkaichao@gmail.com>\nSigned-off-by: DarkLight1337 <tlleungac@connect.ust.hk>\nSigned-off-by: Chen Zhang <zhangch99@outlook.com>\nSigned-off-by: wangxiyuan <wangxiyuan1007@gmail.com>\nSigned-off-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nSigned-off-by: Jee Jee Li <pandaleefree@gmail.com>\nSigned-off-by: Roger Wang <ywang@roblox.com>\nSigned-off-by: yisheng <yi.sheng@intel.com>\nSigned-off-by: Abatom <abzhonghua@gmail.com>\nSigned-off-by: Liangfu Chen <liangfc@amazon.com>\nSigned-off-by: Russell Bryant <rbryant@redhat.com>\nSigned-off-by: Yuan Zhou <yuan.zhou@intel.com>\nSigned-off-by: Sourashis Roy <sroy@roblox.com>\nSigned-off-by: Nishidha Panpaliya <nishidha.panpaliya@partner.ibm.com>\nSigned-off-by: Ilya Lavrenov <ilya.lavrenov@intel.com>\nSigned-off-by: simon-mo <simon.mo@hey.com>\nSigned-off-by: Wallas Santos <wallashss@ibm.com>\nSigned-off-by: jiang1.li <jiang1.li@intel.com>\nSigned-off-by: yan ma <yan.ma@intel.com>\nSigned-off-by: Randall Smith <Randall.Smith@amd.com>\nSigned-off-by: Max de Bayser <mbayser@br.ibm.com>\nSigned-off-by: mgoin <michael@neuralmagic.com>\nSigned-off-by: Maxime Fournioux <55544262+mfournioux@users.noreply.github.com>\nSigned-off-by: Ye Qi <yeq@meta.com>\nSigned-off-by: Mengqing Cao <cmq0113@163.com>\nSigned-off-by: Joe Runde <Joseph.Runde@ibm.com>\nSigned-off-by: Kunshang Ji <kunshang.ji@intel.com>\nSigned-off-by: Kuntai Du <kuntai@uchicago.edu>\nSigned-off-by: Isotr0py <2037008807@qq.com>\nSigned-off-by: Ren MinMin <renmm6@chinaunicom.cn>\nSigned-off-by: Travis Johnson <tsjohnso@us.ibm.com>\nSigned-off-by: Fred Reiss <frreiss@us.ibm.com>\nSigned-off-by: Sungjae Lee <33976427+llsj14@users.noreply.github.com>\nSigned-off-by: shaochangxu.scx <shaochangxu.scx@antgroup.com>\nSigned-off-by: NickLucche <nlucches@redhat.com>\nSigned-off-by: Rafael Vasquez <rafvasq21@gmail.com>\nSigned-off-by: Akshat Tripathi <akshat@krai.ai>\nSigned-off-by: Oleg Mosalov <oleg@krai.ai>\nSigned-off-by: rshaw@neuralmagic.com <rshaw@neuralmagic.com>\nSigned-off-by: Yida Wu <yidawu@alumni.cmu.edu>\nSigned-off-by: Chenguang Li <757486878@qq.com>\nSigned-off-by: Alex-Brooks <Alex.brooks@ibm.com>\nSigned-off-by: Shanshan Shen <467638484@qq.com>\nSigned-off-by: elijah <f1renze.142857@gmail.com>\nSigned-off-by: Konrad Zawora <kzawora@habana.ai>\nSigned-off-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\nSigned-off-by: Rui Qiao <ruisearch42@gmail.com>\nSigned-off-by: Kyle Sayers <kylesayrs@gmail.com>\nSigned-off-by: Rahul Tuli <rahul@neuralmagic.com>\nSigned-off-by: kewang-xlnx <kewang@xilinx.com>\nSigned-off-by: kewang2 <kewang2@amd.com>\nSigned-off-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nSigned-off-by: Yuan Tang <terrytangyuan@gmail.com>\nSigned-off-by: Divakar Verma <divakar.verma@amd.com>\nSigned-off-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nSigned-off-by: hongxyan <hongxyan@amd.com>\nSigned-off-by: Michal Adamczyk <madamczyk@habana.ai>\nSigned-off-by: zibai <zibai.gj@alibaba-inc.com>\nSigned-off-by: Martin Gleize <mgleize@meta.com>\nSigned-off-by: Shangming Cai <caishangming@linux.alibaba.com>\nSigned-off-by: isikhi <huseyin.isik000@gmail.com>\nSigned-off-by: Jason Cheng <jasoncky96@gmail.com>\nSigned-off-by: Jinzhen Lin <linjinzhen@hotmail.com>\nSigned-off-by: Thomas Parnell <tpa@zurich.ibm.com>\nSigned-off-by: Jannis Sch√∂nleber <joennlae@gmail.com>\nSigned-off-by: rickyx <rickyx@anyscale.com>\nSigned-off-by: Andy Lo <andy@mistral.ai>\nSigned-off-by: Adrian Cole <adrian.cole@elastic.co>\nSigned-off-by: maleksan85 <maleksan@amd.com>\nSigned-off-by: Hongxia Yang <hongxyan@amd.com>\nSigned-off-by: kevin <kevin@anyscale.com>\nSigned-off-by: Nick Hill <nhill@redhat.com>\nSigned-off-by: xffxff <1247714429@qq.com>\nSigned-off-by: wangerxiao <863579016@qq.com>\nSigned-off-by: Alexei V. Ivanov <alexei.ivanov@amd.com>\nSigned-off-by: zhenwei <zhenweiliu@habana.ai>\nSigned-off-by: Lucas Wilkinson <lwilkinson@neuralmagic.com>\nSigned-off-by: Siyuan Liu <lsiyuan@google.com>\nSigned-off-by: ElizaWszola <eliza@neuralmagic.com>\nSigned-off-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\nSigned-off-by: Omer Dayan (SW-GPU) <omer@run.ai>\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com>\nSigned-off-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nSigned-off-by: Tyler Michael Smith <tyler@neuralmagic.com>\nSigned-off-by: Kyle Mistele <kyle@mistele.com>\nSigned-off-by: Pooya Davoodi <pooya.davoodi@parasail.io>\nSigned-off-by: Mark McLoughlin <markmc@redhat.com>\nSigned-off-by: Bowen Wang <abmfy@icloud.com>\nSigned-off-by: charlifu <charlifu@amd.com>\nSigned-off-by: vllmellm <vllm.ellm@embeddedllm.com>\nCo-authored-by: youkaichao <youkaichao@gmail.com>\nCo-authored-by: Cyrus Leung <tlleungac@connect.ust.hk>\nCo-authored-by: Chen Zhang <zhangch99@outlook.com>\nCo-authored-by: wangxiyuan <wangxiyuan1007@gmail.com>\nCo-authored-by: Harry Mellor <19981378+hmellor@users.noreply.github.com>\nCo-authored-by: Gregory Shtrasberg <Gregory.Shtrasberg@amd.com>\nCo-authored-by: maang-h <55082429+maang-h@users.noreply.github.com>\nCo-authored-by: Gregory Shtrasberg <156009573+gshtras@users.noreply.github.com>\nCo-authored-by: Jee Jee Li <pandaleefree@gmail.com>\nCo-authored-by: Roger Wang <136131678+ywang96@users.noreply.github.com>\nCo-authored-by: YiSheng5 <yi.sheng@intel.com>\nCo-authored-by: Zhonghua Deng <abatom@163.com>\nCo-authored-by: Liangfu Chen <liangfc@amazon.com>\nCo-authored-by: XiaobingZhang <xiaobingzhangupc@gmail.com>\nCo-authored-by: Russell Bryant <rbryant@redhat.com>\nCo-authored-by: Yuan <yuan.zhou@intel.com>\nCo-authored-by: Cyrus Leung <cyrus.tl.leung@gmail.com>\nCo-authored-by: jiangjiadi <34134495+jiangjiadi@users.noreply.github.com>\nCo-authored-by: jiadi.jjd <jiadi.jjd@antgroup.com>\nCo-authored-by: sroy745 <142070531+sroy745@users.noreply.github.com>\nCo-authored-by: Jie Fu (ÂÇÖÊù∞) <jiefu@tencent.com>\nCo-authored-by: Divakar Verma <137818590+divakar-amd@users.noreply.github.com>\nCo-authored-by: WangErXiao <863579016@qq.com>\nCo-authored-by: Nishidha <nishidha.panpaliya@partner.ibm.com>\nCo-authored-by: Ilya Lavrenov <ilya.lavrenov@intel.com>\nCo-authored-by: Simon Mo <simon.mo@hey.com>\nCo-authored-by: Wallas Henrique <wallashss@users.noreply.github.com>\nCo-authored-by: Michael Goin <michael@neuralmagic.com>\nCo-authored-by: Li, Jiang <jiang1.li@intel.com>\nCo-authored-by: Yan Ma <yan.ma@intel.com>\nCo-authored-by: Robert Shaw <114415538+robertgshaw2-neuralmagic@users.noreply.github.com>\nCo-authored-by: Woosuk Kwon <woosuk.kwon@berkeley.edu>\nCo-authored-by: rasmith <Randall.Smith@amd.com>\nCo-authored-by: Tyler Michael Smith <tyler@neuralmagic.com>\nCo-authored-by: Maximilien de Bayser <mbayser@br.ibm.com>\nCo-authored-by: Maxime Fournioux <55544262+mfournioux@users.noreply.github.com>\nCo-authored-by: Guspan Tanadi <36249910+guspan-tanadi@users.noreply.github.com>\nCo-authored-by: Ye (Charlotte) Qi <ye.charlotte.qi@gmail.com>\nCo-authored-by: yeq <yeq@devgpu004.lla3.facebook.com>\nCo-authored-by: Mengqing Cao <cmq0113@163.com>\nCo-authored-by: Charles Frye <cfrye59@gmail.com>\nCo-authored-by: Joe Runde <Joseph.Runde@ibm.com>\nCo-authored-by: Kunshang Ji <kunshang.ji@intel.com>\nCo-authored-by: cennn <61925104+cennn@users.noreply.github.com>\nCo-authored-by: Kuntai Du <kuntai@uchicago.edu>\nCo-authored-by: Isotr0py <mozf@mail2.sysu.edu.cn>\nCo-authored-by: minmin <rmm0811@gmail.com>\nCo-authored-by: Ren MinMin <renmm6@chinaunicom.cn>\nCo-authored-by: Travis Johnson <tsjohnso@us.ibm.com>\nCo-authored-by: Fred Reiss <frreiss@us.ibm.com>\nCo-authored-by: Sungjae Lee <33976427+llsj14@users.noreply.github.com>\nCo-authored-by: shaochangxu <85155497+shaochangxu@users.noreply.github.com>\nCo-authored-by: shaochangxu.scx <shaochangxu.scx@antgroup.com>\nCo-authored-by: Nicol√≤ Lucchesi <nlucches@redhat.com>\nCo-authored-by: sixgod <evethwillbeok@outlook.com>\nCo-authored-by: Isotr0py <2037008807@qq.com>\nCo-authored-by: Rafael Vasquez <rafvasq21@gmail.com>\nCo-authored-by: Akshat Tripathi <Akshat.tripathi6568@gmail.com>\nCo-authored-by: Oleg Mosalov <oleg@krai.ai>\nCo-authored-by: Avshalom Manevich <12231371+avshalomman@users.noreply.github.com>\nCo-authored-by: Yangcheng Li <liyangcheng.lyc@alibaba-inc.com>\nCo-authored-by: Siyuan Li <94890248+liaoyanqing666@users.noreply.github.com>\nCo-authored-by: Concurrensee <yida.wu@amd.com>\nCo-authored-by: Chenguang Li <757486878@qq.com>\nCo-authored-by: Alex Brooks <alex.brooks@ibm.com>\nCo-authored-by: Shanshan Shen <467638484@qq.com>\nCo-authored-by: elijah <30852919+e1ijah1@users.noreply.github.com>\nCo-authored-by: Konrad Zawora <kzawora@habana.ai>\nCo-authored-by: Elfie Guo <164945471+elfiegg@users.noreply.github.com>\nCo-authored-by: Rui Qiao <161574667+ruisearch42@users.noreply.github.com>\nCo-authored-by: Kyle Sayers <kylesayrs@gmail.com>\nCo-authored-by: Rahul Tuli <rahul@neuralmagic.com>\nCo-authored-by: Keyun Tong <tongkeyun@gmail.com>\nCo-authored-by: RunningLeon <maningsheng@sensetime.com>\nCo-authored-by: kewang-xlnx <73578509+kewang-xlnx@users.noreply.github.com>\nCo-authored-by: kewang2 <kewang2@amd.com>\nCo-authored-by: Varun Sundar Rabindranath <varunsundar08@gmail.com>\nCo-authored-by: Varun Sundar Rabindranath <varun@neuralmagic.com>\nCo-authored-by: tvirolai-amd <teemu.virolainen@amd.com>\nCo-authored-by: Michael Goin <mgoin@redhat.com>\nCo-authored-by: Zhaoyi Li <36555117+Lzy17@users.noreply.github.com>\nCo-authored-by: charlifu <charlifu@amd.com>\nCo-authored-by: Yuan Tang <terrytangyuan@gmail.com>\nCo-authored-by: Cody Yu <hao.yu.cody@gmail.com>\nCo-authored-by: Hongxia Yang <62075498+hongxiayang@users.noreply.github.com>\nCo-authored-by: yancong <32220263+ice-tong@users.noreply.github.com>\nCo-authored-by: Michal Adamczyk <madamczyk@habana.ai>\nCo-authored-by: gujing <925973396@qq.com>\nCo-authored-by: imkero <kerorek@outlook.com>\nCo-authored-by: Martin Gleize <mgleize@meta.com>\nCo-authored-by: mgleize user <mgleize@a100-st-p4de24xlarge-4.fair-a100.hpcaas>\nCo-authored-by: shangmingc <caishangming@linux.alibaba.com>\nCo-authored-by: I≈üƒ±k <41375111+isikhi@users.noreply.github.com>\nCo-authored-by: Roger Wang <ywang@roblox.com>\nCo-authored-by: Cheng Kuan Yong Jason <jasoncky96@gmail.com>\nCo-authored-by: Jinzhen Lin <linjinzhen@hotmail.com>\nCo-authored-by: Thomas Parnell <tpa@zurich.ibm.com>\nCo-authored-by: Jannis Sch√∂nleber <joennlae@gmail.com>\nCo-authored-by: Ricky Xu <xuchen727@hotmail.com>\nCo-authored-by: Andy Lo <andylolu24@gmail.com>\nCo-authored-by: Adrian Cole <64215+codefromthecrypt@users.noreply.github.com>\nCo-authored-by: Jani Monoses <jani.monoses@gmail.com>\nCo-authored-by: Kevin H. Luu <kevin@anyscale.com>\nCo-authored-by: Aleksandr Malyshev <164964928+maleksan85@users.noreply.github.com>\nCo-authored-by: maleksan85 <maleksan@amd.com>\nCo-authored-by: Nick Hill <nickhill@us.ibm.com>\nCo-authored-by: zhou fan <1247714429@qq.com>\nCo-authored-by: ilia-cher <30845429+ilia-cher@users.noreply.github.com>\nCo-authored-by: Alexei-V-Ivanov-AMD <156011006+Alexei-V-Ivanov-AMD@users.noreply.github.com>\nCo-authored-by: liuzhenwei <zhenweiliu@habana.ai>\nCo-authored-by: Lucas Wilkinson <LucasWilkinson@users.noreply.github.com>\nCo-authored-by: Micah Williamson <micah.williamson@amd.com>\nCo-authored-by: Siyuan Liu <lsiyuan@google.com>\nCo-authored-by: Dipika Sikka <dipikasikka1@gmail.com>\nCo-authored-by: ElizaWszola <eliza@neuralmagic.com>\nCo-authored-by: Junichi Sato <junichi.sato@sbintuitions.co.jp>\nCo-authored-by: amd-ruitang3 <Rui.Tang2@amd.com>\nCo-authored-by: Robert Shaw <rshaw@neuralmagic.com>\nCo-authored-by: omer-dayan <omer@run.ai>\nCo-authored-by: Mohit Deopujari <mdeopujari@habana.ai>\nCo-authored-by: Jeremy Arnold <103538711+JArnoldAMD@users.noreply.github.com>\nCo-authored-by: chenjun <junchen2@amd.com>\nCo-authored-by: ValarLip <340077269@qq.com>\nCo-authored-by: Matthew Hendrey <matthew.hendrey@gmail.com>\nCo-authored-by: Kyle Mistele <kyle@mistele.com>\nCo-authored-by: Pooya Davoodi <pooya.davoodi@parasail.io>\nCo-authored-by: Mark McLoughlin <markmc@redhat.com>\nCo-authored-by: Bowen Wang <abmfy@icloud.com>\nCo-authored-by: Bowen Bao <bowenbao@amd.com>\nCo-authored-by: arakowsk-amd <182798202+arakowsk-amd@users.noreply.github.com>\nCo-authored-by: Matthew Wong <Matthew.Wong2@amd.com>\nCo-authored-by: sanyalington <shomy.sanyal@amd.com>\nCo-authored-by: Joe Shajrawi <17753158+shajrawi@users.noreply.github.com>\nCo-authored-by: vllmellm <vllm.ellm@embeddedllm.com>\nCo-authored-by: charlifu <chalifu@amd.com> mzusman pushed a commit\n        to mzusman/vllm\n      that referenced\n      this pull request Mar 12, 2025 [V1][Perf] Reduce scheduling overhead in model runner after cuda sync ( ‚Ä¶ ‚Ä¶ bdf42bf ‚Ä¶vllm-project#12094 )\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com> Sign up for free to join this conversation on GitHub .\n    Already have an account? Sign in to comment",
  "timeline_extracted_at": "2025-09-07 17:46:54",
  "has_lm_eval": false,
  "has_performance": true,
  "has_serving": true,
  "has_general_test": true,
  "test_details": "PERF: Throughput, Throughput, Throughput | SERVING: serving, serving, serving | TEST: test, test, test",
  "analysis_extracted_at": "2025-09-07 17:46:54",
  "models": [
    "N/A"
  ],
  "lm_eval_commands": null,
  "perf_command": "VLLM_USE_V1=1 python3 benchmarks/benchmark_latency.py --model \"/data/users/ktong/llama/llm_8b_oss\" --tensor-parallel-size 1 --input_len 1000 --batch_size 32",
  "commit_subject": "[V1][Perf] Reduce scheduling overhead in model runner after cuda sync (#12094)",
  "commit_message": "[V1][Perf] Reduce scheduling overhead in model runner after cuda sync (#12094)\n\nSigned-off-by: Keyun Tong <tongkeyun@gmail.com>",
  "commit_date": "2025-01-26T00:42:37-08:00",
  "files_changed": [
    "vllm/v1/outputs.py",
    "vllm/v1/sample/sampler.py",
    "vllm/v1/worker/gpu_model_runner.py"
  ],
  "functions_changed": [],
  "stats": {
    "num_test_files": 0,
    "num_non_test_files": 3,
    "only_test_files": 0,
    "only_non_test_files": 1,
    "num_files": 3,
    "num_hunks": 6,
    "num_edited_lines": 34,
    "num_non_test_edited_lines": 34,
    "commit_year": 2025
  },
  "diff_text": "diff --git a/vllm/v1/outputs.py b/vllm/v1/outputs.py\nindex acc3a944e..32aee44e3 100644\n--- a/vllm/v1/outputs.py\n+++ b/vllm/v1/outputs.py\n@@ -8,7 +8,7 @@ import torch\n class SamplerOutput:\n \n     # [num_reqs]\n-    sampled_token_ids: List[int]\n+    sampled_token_ids: torch.Tensor\n \n     # [num_reqs, max_num_logprobs + 1]\n     logprob_token_ids: Optional[torch.Tensor]\ndiff --git a/vllm/v1/sample/sampler.py b/vllm/v1/sample/sampler.py\nindex 7cd42ca21..9ad665a64 100644\n--- a/vllm/v1/sample/sampler.py\n+++ b/vllm/v1/sample/sampler.py\n@@ -50,9 +50,8 @@ class Sampler(nn.Module):\n         # Use int32 to reduce the tensor size.\n         sampled = sampled.to(torch.int32)\n \n-        # NOTE: CPU-GPU synchronization happens here.\n         sampler_output = SamplerOutput(\n-            sampled_token_ids=sampled.tolist(),\n+            sampled_token_ids=sampled,\n             logprob_token_ids=topk_indices,\n             logprobs=topk_logprobs,\n             prompt_logprob_token_ids=None,\ndiff --git a/vllm/v1/worker/gpu_model_runner.py b/vllm/v1/worker/gpu_model_runner.py\nindex 4b3c325de..6339f1f03 100644\n--- a/vllm/v1/worker/gpu_model_runner.py\n+++ b/vllm/v1/worker/gpu_model_runner.py\n@@ -775,10 +775,10 @@ class GPUModelRunner:\n             sampling_metadata=sampling_metadata,\n         )\n \n-        sampled_token_ids = sampler_output.sampled_token_ids\n         # TODO(woosuk): The following loop can be slow since it iterates over\n         # the requests one by one. Optimize.\n         num_reqs = self.input_batch.num_reqs\n+        request_seq_lens: List[Tuple[int, CachedRequestState, int]] = []\n         for i, req_id in enumerate(self.input_batch.req_ids[:num_reqs]):\n             assert req_id is not None\n             req_state = self.requests[req_id]\n@@ -787,10 +787,10 @@ class GPUModelRunner:\n             assert seq_len <= req_state.num_tokens\n             if seq_len == req_state.num_tokens:\n                 # Append the sampled token to the output token ids.\n-                token_id = sampled_token_ids[i]\n-                self.input_batch.token_ids_cpu[i, seq_len] = token_id\n                 self.input_batch.num_tokens[i] += 1\n-                req_state.output_token_ids.append(token_id)\n+                # OPTIMIZATION: Priming the state updates for later updates.\n+                req_state.output_token_ids.append(0)\n+                request_seq_lens.append((i, req_state, seq_len))\n             else:\n                 # Ignore the sampled token from the partial request.\n                 # Rewind the generator state as if the token was not sampled.\n@@ -799,6 +799,21 @@ class GPUModelRunner:\n                     # This relies on cuda-specific torch-internal impl details\n                     generator.set_offset(generator.get_offset() - 4)\n \n+        # num_reqs entries should be non-None\n+        assert all(\n+            req_id is not None for req_id in\n+            self.input_batch.req_ids[:num_reqs]), \"req_ids contains None\"\n+        req_ids = cast(List[str], self.input_batch.req_ids[:num_reqs])\n+\n+        # NOTE: GPU -> CPU Sync happens here.\n+        # Move as many CPU operations as possible before this sync point.\n+        sampled_token_ids = sampler_output.sampled_token_ids.tolist()\n+        # Update with the actual token ids\n+        for i, req_state, seq_len in request_seq_lens:\n+            token_id = sampled_token_ids[i]\n+            self.input_batch.token_ids_cpu[i, seq_len] = token_id\n+            req_state.output_token_ids[-1] = token_id\n+\n         if sampler_output.logprob_token_ids is None:\n             logprob_token_ids = None\n         else:\n@@ -808,12 +823,6 @@ class GPUModelRunner:\n         else:\n             logprobs = sampler_output.logprobs.cpu()\n \n-        # num_reqs entries should be non-None\n-        assert all(\n-            req_id is not None for req_id in\n-            self.input_batch.req_ids[:num_reqs]), \"req_ids contains None\"\n-        req_ids = cast(List[str], self.input_batch.req_ids[:num_reqs])\n-\n         model_runner_output = ModelRunnerOutput(\n             req_ids=req_ids,\n             req_id_to_index=self.input_batch.req_id_to_index,",
  "apis": [
    "vllm.v1.outputs.SamplerOutput",
    "vllm.v1.sample.sampler.Sampler.forward",
    "vllm.v1.worker.GPUModelRunner.execute_model"
  ],
  "affected_paths": [
    "/Users/fortuna/buckets/gso_bucket/analysis/repos/vllm/vllm/v1/worker/gpu_model_runner.py",
    "/Users/fortuna/buckets/gso_bucket/analysis/repos/vllm/vllm/v1/sample/sampler.py",
    "/Users/fortuna/buckets/gso_bucket/analysis/repos/vllm/vllm/model_executor/layers/sampler.py",
    "/Users/fortuna/buckets/gso_bucket/analysis/repos/vllm/vllm/v1/sample/tpu/sampler.py",
    "/Users/fortuna/buckets/gso_bucket/analysis/repos/vllm/vllm/outputs.py",
    "/Users/fortuna/buckets/gso_bucket/analysis/repos/vllm/vllm/v1/outputs.py"
  ],
  "repo_path": "/Users/fortuna/buckets/gso_bucket/analysis/repos/vllm",
  "llm_reason": "The commit modifies several non-test source files (outputs.py, sampler.py, gpu_model_runner.py) and makes non-trivial changes to how data is handled. Specifically, it postpones the conversion of the sampled tokens to Python list until after some CPU operations, and it batches certain state updates to reduce the GPU-to-CPU synchronization overhead. These changes aim at reducing scheduling overhead and optimizing the CPU performance of the model runner‚Äîexactly a performance optimization rather than mere refactoring, bugfixing, or feature addition. Overall, the changes target performance improvements in a high-level API and are testable on CPU without relying on GPU-specific optimizations.",
  "llm_api_reason": "The commit changes the handling of sampled token IDs to avoid unnecessary CPU‚ÄìGPU transfers. In outputs.py the SamplerOutput‚Äôs sampled_token_ids field is changed from a list of ints to a torch.Tensor. In sampler.py the Sampler.forward method now returns the sampled tokens directly as a tensor (instead of converting them to a list), and in GPUModelRunner.execute_model the logic is updated so that the token IDs are deferred until after a GPU‚ÄìCPU sync and then patched into the persistent input batch. These changes reduce scheduling overhead and improve performance while maintaining the same external behavior."
}