Implemented targeted performance optimizations and added a local benchmark harness.
