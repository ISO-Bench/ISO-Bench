Changes implemented and validated. I made safe, general micro-optimizations in the four targeted entrypoints, added a quick local benchmark to sanity-check overhead, and produced the required diff.
