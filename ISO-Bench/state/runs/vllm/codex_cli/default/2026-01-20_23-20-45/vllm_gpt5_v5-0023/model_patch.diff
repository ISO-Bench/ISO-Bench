diff --git a/vllm/worker/model_runner.py b/vllm/worker/model_runner.py
index cf2f1c6..ac6c6d9 100644
--- a/vllm/worker/model_runner.py
+++ b/vllm/worker/model_runner.py
@@ -821,12 +821,21 @@ class ModelInputForGPUBuilder(ModelRunnerInputBuilderBase[ModelInputForGPU]):
         """
         # Combine and flatten intermediate data.
         input_tokens = []
-        token_types = []
+        # Many models do not provide token type ids; avoid flattening
+        # potentially large lists of empties by first checking if any
+        # token type data exists across all groups.
+        has_token_types = False
         for inter_data in self.inter_data_list:
             for cur_input_tokens in inter_data.input_tokens:
                 input_tokens.extend(cur_input_tokens)
-            for cur_token_types in inter_data.token_types:
-                token_types.extend(cur_token_types)
+            # cheap existence check without materializing a flattened list
+            if not has_token_types and any(cur for cur in inter_data.token_types):
+                has_token_types = True
+        token_types = [] if has_token_types else None
+        if has_token_types:
+            for inter_data in self.inter_data_list:
+                for cur_token_types in inter_data.token_types:
+                    token_types.extend(cur_token_types)
 
         if not input_tokens:
             # This may happen when all prefill requests hit
