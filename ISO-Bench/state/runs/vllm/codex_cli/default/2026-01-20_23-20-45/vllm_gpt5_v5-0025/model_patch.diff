diff --git a/tests/core/block/e2e/test_correctness.py b/tests/core/block/e2e/test_correctness.py
index e9b537e..6eb5a7d 100644
--- a/tests/core/block/e2e/test_correctness.py
+++ b/tests/core/block/e2e/test_correctness.py
@@ -166,11 +166,11 @@ def test_lookahead_greedy_equality_with_preemption(baseline_llm_generator,
         temperature=temperature,
     )
 
-    print('Getting token ids without lookahead scheduling')
+    # Avoid extra I/O in tests for speed.
     baseline_token_ids = get_token_ids_from_llm_generator(
         baseline_llm_generator, prompts, sampling_params)
 
-    print('Getting token ids with lookahead scheduling')
+    # Run with lookahead scheduling
     test_token_ids = get_token_ids_from_llm_generator(test_llm_generator,
                                                       prompts, sampling_params)
 
@@ -244,11 +244,11 @@ def test_chunked_prefill_block_manager(baseline_llm_generator,
         temperature=temperature,
     )
 
-    print('Getting token ids with BlockManager')
+    # Baseline run
     baseline_token_ids = get_token_ids_from_llm_generator(
         baseline_llm_generator, prompts, sampling_params)
 
-    print('Getting token ids with BlockManager, with lookahead slots.')
+    # Run with lookahead slots
     test_token_ids = get_token_ids_from_llm_generator(test_llm_generator,
                                                       prompts, sampling_params)
 
@@ -325,11 +325,11 @@ def test_block_manager_prefix_caching_enabled_with_preemption(
         temperature=temperature,
     )
 
-    print('Getting token ids from block manager')
+    # Baseline run
     baseline_token_ids = get_token_ids_from_llm_generator(
         baseline_llm_generator, prompts, sampling_params)
 
-    print('Getting token ids from block manager, with preemption')
+    # Run with preemption
     test_token_ids = get_token_ids_from_llm_generator(test_llm_generator,
                                                       prompts, sampling_params)
 
@@ -399,11 +399,11 @@ def test_auto_prefix_caching_with_preemption(baseline_llm_generator,
         temperature=temperature,
     )
 
-    print('Getting token ids with APC disabled')
+    # Baseline run (APC disabled)
     baseline_token_ids = get_token_ids_from_llm_generator(
         baseline_llm_generator, prompts, sampling_params)
 
-    print('Getting token ids with APC enabled')
+    # Run with APC enabled
     test_token_ids = get_token_ids_from_llm_generator(test_llm_generator,
                                                       prompts, sampling_params)
 
diff --git a/vllm/attention/ops/prefix_prefill.py b/vllm/attention/ops/prefix_prefill.py
index e0478c2..d03bed1 100644
--- a/vllm/attention/ops/prefix_prefill.py
+++ b/vllm/attention/ops/prefix_prefill.py
@@ -99,9 +99,9 @@ if triton.__version__ >= "2.1.0":
             (cur_batch_in_all_start_index + offs_m[:, None]) * stride_qbs +
             cur_head * stride_qh + offs_d[None, :] * stride_qd)
 
-        dim_mask = tl.where(
-            tl.arange(0, BLOCK_DMODEL_PADDED) < BLOCK_DMODEL, 1,
-            0).to(tl.int1)  # [D]
+        # Use a lightweight boolean/int1 mask derived from existing `offs_d`.
+        # This avoids creating an extra arange + cast on every program.
+        dim_mask = (offs_d < BLOCK_DMODEL)  # [D]
 
         q = tl.load(Q + off_q,
                     mask=dim_mask[None, :] &
