Plan: I created a small CPU-only timing script to measure padding + tensorization cost, then implemented targeted optimizations in the three specified files focused on faster token padding and reduced Python overhead. Finally, I staged and committed the code changes and generated a model_patch.diff.
