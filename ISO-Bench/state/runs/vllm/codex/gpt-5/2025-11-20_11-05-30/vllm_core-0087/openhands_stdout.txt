Optimizations implemented and validated. I focused on reducing per-step memory allocations and transfers in guided decoding, plus a small bugfix in sequence handling.
