I created a small benchmark, applied targeted optimizations in the sampler, and verified behavior and performance.
