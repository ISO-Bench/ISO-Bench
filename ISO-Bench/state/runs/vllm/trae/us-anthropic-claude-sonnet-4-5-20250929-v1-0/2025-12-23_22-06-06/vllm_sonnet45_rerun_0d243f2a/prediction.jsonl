{"instance_id": "/home/ubuntu/OmniPerf-Bench/vllm__repo-88f6ba3", "model_patch": "diff --git a/vllm/model_executor/layers/fused_moe/configs/E=8,N=14336,device_name=AMD_Instinct_MI300X.json b/vllm/model_executor/layers/fused_moe/configs/E=8,N=14336,device_name=AMD_Instinct_MI300X.json\nindex 66f9106..6c5f53f 100644\n--- a/vllm/model_executor/layers/fused_moe/configs/E=8,N=14336,device_name=AMD_Instinct_MI300X.json\n+++ b/vllm/model_executor/layers/fused_moe/configs/E=8,N=14336,device_name=AMD_Instinct_MI300X.json\n@@ -110,12 +110,12 @@\n         \"kpack\": 1\n     },\n     \"128\": {\n-        \"BLOCK_SIZE_M\": 64,\n+        \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 64,\n         \"BLOCK_SIZE_K\": 128,\n-        \"GROUP_SIZE_M\": 4,\n-        \"num_warps\": 4,\n-        \"num_stages\": 2,\n+        \"GROUP_SIZE_M\": 8,\n+        \"num_warps\": 8,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n         \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n@@ -123,78 +123,78 @@\n     \"256\": {\n         \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 4,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"512\": {\n         \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 4,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"1024\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"1536\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"2048\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"3072\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"4096\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     }\n }\ndiff --git a/vllm/model_executor/layers/fused_moe/configs/E=8,N=3584,device_name=AMD_Instinct_MI300X.json b/vllm/model_executor/layers/fused_moe/configs/E=8,N=3584,device_name=AMD_Instinct_MI300X.json\nindex ed5b655..c6feb61 100644\n--- a/vllm/model_executor/layers/fused_moe/configs/E=8,N=3584,device_name=AMD_Instinct_MI300X.json\n+++ b/vllm/model_executor/layers/fused_moe/configs/E=8,N=3584,device_name=AMD_Instinct_MI300X.json\n@@ -110,91 +110,91 @@\n         \"kpack\": 2\n     },\n     \"128\": {\n-        \"BLOCK_SIZE_M\": 64,\n+        \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 64,\n         \"BLOCK_SIZE_K\": 256,\n-        \"GROUP_SIZE_M\": 1,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"256\": {\n-        \"BLOCK_SIZE_M\": 64,\n+        \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 64,\n         \"BLOCK_SIZE_K\": 128,\n-        \"GROUP_SIZE_M\": 1,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"512\": {\n-        \"BLOCK_SIZE_M\": 64,\n+        \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 128,\n         \"BLOCK_SIZE_K\": 128,\n-        \"GROUP_SIZE_M\": 1,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n         \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"1024\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"1536\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"2048\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"3072\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"4096\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     }\n }\ndiff --git a/vllm/model_executor/layers/fused_moe/configs/E=8,N=7168,device_name=AMD_Instinct_MI300X.json b/vllm/model_executor/layers/fused_moe/configs/E=8,N=7168,device_name=AMD_Instinct_MI300X.json\nindex 822f04e..c2fabca 100644\n--- a/vllm/model_executor/layers/fused_moe/configs/E=8,N=7168,device_name=AMD_Instinct_MI300X.json\n+++ b/vllm/model_executor/layers/fused_moe/configs/E=8,N=7168,device_name=AMD_Instinct_MI300X.json\n@@ -110,23 +110,23 @@\n         \"kpack\": 2\n     },\n     \"128\": {\n-        \"BLOCK_SIZE_M\": 64,\n+        \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 64,\n         \"BLOCK_SIZE_K\": 128,\n-        \"GROUP_SIZE_M\": 4,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"256\": {\n         \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 128,\n         \"BLOCK_SIZE_K\": 128,\n-        \"GROUP_SIZE_M\": 4,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n         \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n@@ -134,67 +134,67 @@\n     \"512\": {\n         \"BLOCK_SIZE_M\": 128,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 3,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"1024\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"1536\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"2048\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"3072\": {\n-        \"BLOCK_SIZE_M\": 128,\n+        \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     },\n     \"4096\": {\n         \"BLOCK_SIZE_M\": 256,\n         \"BLOCK_SIZE_N\": 128,\n-        \"BLOCK_SIZE_K\": 64,\n-        \"GROUP_SIZE_M\": 1,\n+        \"BLOCK_SIZE_K\": 128,\n+        \"GROUP_SIZE_M\": 8,\n         \"num_warps\": 8,\n-        \"num_stages\": 2,\n+        \"num_stages\": 4,\n         \"waves_per_eu\": 0,\n-        \"matrix_instr_nonkdim\": 16,\n+        \"matrix_instr_nonkdim\": 32,\n         \"kpack\": 2\n     }\n }\n", "model_name_or_path": "gpt-5-2025-08-07"}
