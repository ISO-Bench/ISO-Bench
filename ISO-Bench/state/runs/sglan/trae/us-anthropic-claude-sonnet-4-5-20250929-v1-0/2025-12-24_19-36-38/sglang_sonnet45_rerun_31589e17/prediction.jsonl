{"instance_id": "/home/ubuntu/OmniPerf-Bench/sglan__repo-ae6a5b2", "model_patch": "diff --git a/python/sglang/srt/models/deepseek_v2.py b/python/sglang/srt/models/deepseek_v2.py\nindex 29f18f0..8fba375 100644\n--- a/python/sglang/srt/models/deepseek_v2.py\n+++ b/python/sglang/srt/models/deepseek_v2.py\n@@ -367,8 +367,8 @@ class DeepseekV2MoE(nn.Module):\n                 ),\n             )\n         else:\n-            topk_idx = torch.full(\n-                (0, self.top_k), -1, dtype=torch.int, device=hidden_states.device\n+            topk_idx = torch.empty(\n+                (0, self.top_k), dtype=torch.int, device=hidden_states.device\n             )\n             topk_weights = torch.empty(\n                 (0, self.top_k), dtype=torch.float32, device=hidden_states.device\n@@ -459,8 +459,8 @@ class DeepseekV2MoE(nn.Module):\n                 ),\n             )\n         else:\n-            state.topk_idx_local = torch.full(\n-                (0, self.top_k), -1, dtype=torch.int, device=hidden_states.device\n+            state.topk_idx_local = torch.empty(\n+                (0, self.top_k), dtype=torch.int, device=hidden_states.device\n             )\n             state.topk_weights_local = torch.empty(\n                 (0, self.top_k), dtype=torch.float32, device=hidden_states.device\ndiff --git a/python/sglang/srt/two_batch_overlap.py b/python/sglang/srt/two_batch_overlap.py\nindex 6b0241f..30d2465 100644\n--- a/python/sglang/srt/two_batch_overlap.py\n+++ b/python/sglang/srt/two_batch_overlap.py\n@@ -324,7 +324,7 @@ class TboForwardBatchPreparer:\n         # TODO improve, e.g. unify w/ `init_raw`\n         if global_server_args_dict[\"moe_dense_tp_size\"] == 1:\n             sum_len = end_token_index - start_token_index\n-            gathered_buffer = torch.zeros(\n+            gathered_buffer = torch.empty(\n                 (sum_len, batch.gathered_buffer.shape[1]),\n                 dtype=batch.gathered_buffer.dtype,\n                 device=batch.gathered_buffer.device,\n", "model_name_or_path": "gpt-5-2025-08-07"}
