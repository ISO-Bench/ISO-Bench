{"instance_id": "/home/ubuntu/OmniPerf-Bench/sglan__repo-f081541", "model_patch": "diff --git a/python/sglang/srt/models/deepseek_v2.py b/python/sglang/srt/models/deepseek_v2.py\nindex 26c5e617a..67f470ff6 100644\n--- a/python/sglang/srt/models/deepseek_v2.py\n+++ b/python/sglang/srt/models/deepseek_v2.py\n@@ -312,8 +312,8 @@ class DeepseekV2MoE(nn.Module):\n         self, hidden_states: torch.Tensor, forward_mode: ForwardMode\n     ) -> torch.Tensor:\n         shared_output = None\n-        topk_idx = torch.full(\n-            (0, self.top_k), -1, dtype=torch.int, device=hidden_states.device\n+        topk_idx = torch.empty(\n+            (0, self.top_k), dtype=torch.int, device=hidden_states.device\n         )\n         topk_weights = torch.empty(\n             (0, self.top_k), dtype=torch.float32, device=hidden_states.device\n@@ -1559,8 +1559,8 @@ class DeepseekV2ForCausalLM(nn.Module):\n                 0, (-1, self_attn.qk_nope_head_dim + self_attn.v_head_dim)\n             ).split([self_attn.qk_nope_head_dim, self_attn.v_head_dim], dim=1)\n             if not use_deep_gemm_bmm:\n-                self_attn.w_kc = w_kc.transpose(1, 2).contiguous().transpose(1, 2)\n-                self_attn.w_vc = w_vc.contiguous().transpose(1, 2)\n+                self_attn.w_kc = w_kc.contiguous()\n+                self_attn.w_vc = w_vc.transpose(1, 2).contiguous()\n                 if (\n                     hasattr(self_attn.kv_b_proj, \"weight_scale\")\n                     and self_attn.w_scale is None\n", "model_name_or_path": "gpt-5-2025-08-07"}
