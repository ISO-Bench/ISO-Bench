{"instance_id": "/home/ubuntu/OmniPerf-Bench/sglan__repo-96c503e", "model_patch": "diff --git a/python/sglang/bench_latency.py b/python/sglang/bench_latency.py\nindex a163cbd30..0025d3d99 100644\n--- a/python/sglang/bench_latency.py\n+++ b/python/sglang/bench_latency.py\n@@ -137,7 +137,7 @@ def prepare_synthetic_inputs(bench_args, tokenizer):\n \n     reqs = []\n     for i in range(len(input_ids)):\n-        req = Req(rid=i, origin_input_text=\"\", origin_input_ids=list(input_ids[i]))\n+        req = Req(rid=i, origin_input_text=\"\", origin_input_ids=input_ids[i].tolist())\n         req.prefix_indices = []\n         req.sampling_params = sampling_params\n         req.input_ids = req.origin_input_ids\ndiff --git a/python/sglang/global_config.py b/python/sglang/global_config.py\nindex 0cc0f747f..edfd768e1 100644\n--- a/python/sglang/global_config.py\n+++ b/python/sglang/global_config.py\n@@ -27,7 +27,7 @@ class GlobalConfig:\n \n         # Request dependency time due to network delay\n         self.request_dependency_delay = 0.02\n-        self.wait_for_new_request_delay = 0.0006\n+        self.wait_for_new_request_delay = 0.0004\n \n         # New generation token ratio estimation\n         self.base_new_token_ratio = 0.4\ndiff --git a/python/sglang/srt/managers/controller/model_runner.py b/python/sglang/srt/managers/controller/model_runner.py\nindex e41514706..4890d5871 100644\n--- a/python/sglang/srt/managers/controller/model_runner.py\n+++ b/python/sglang/srt/managers/controller/model_runner.py\n@@ -69,9 +69,10 @@ class InputMetadata:\n     flashinfer_decode_wrapper: \"BatchDecodeWithPagedKVCacheWrapper\" = None\n \n     def init_flashinfer_args(self, num_qo_heads, num_kv_heads, head_dim):\n-        self.kv_indptr = torch.zeros(\n+        self.kv_indptr = torch.empty(\n             (self.batch_size + 1,), dtype=torch.int32, device=\"cuda\"\n         )\n+        self.kv_indptr[0] = 0\n         self.kv_indptr[1:] = torch.cumsum(self.seq_lens, dim=0)\n         self.kv_last_page_len = torch.ones(\n             (self.batch_size,), dtype=torch.int32, device=\"cuda\"\n@@ -92,9 +93,10 @@ class InputMetadata:\n             self.forward_mode == ForwardMode.PREFILL\n             or self.forward_mode == ForwardMode.EXTEND\n         ):\n-            self.qo_indptr = torch.zeros(\n+            self.qo_indptr = torch.empty(\n                 (self.batch_size + 1,), dtype=torch.int32, device=\"cuda\"\n             )\n+            self.qo_indptr[0] = 0\n             self.qo_indptr[1:] = torch.cumsum(self.extend_seq_lens, dim=0)\n \n             self.flashinfer_prefill_wrapper.end_forward()\n@@ -124,7 +126,8 @@ class InputMetadata:\n \n     def init_extend_args(self):\n         self.extend_seq_lens = self.seq_lens - self.prefix_lens\n-        self.extend_start_loc = torch.zeros_like(self.seq_lens)\n+        self.extend_start_loc = torch.empty_like(self.seq_lens)\n+        self.extend_start_loc[0] = 0\n         self.extend_start_loc[1:] = torch.cumsum(self.extend_seq_lens[:-1], dim=0)\n         self.max_extend_len = int(torch.max(self.extend_seq_lens))\n \n@@ -147,7 +150,8 @@ class InputMetadata:\n         flashinfer_decode_wrapper=None,\n     ):\n         batch_size = len(req_pool_indices)\n-        start_loc = torch.zeros((batch_size,), dtype=torch.int32, device=\"cuda\")\n+        start_loc = torch.empty((batch_size,), dtype=torch.int32, device=\"cuda\")\n+        start_loc[0] = 0\n         start_loc[1:] = torch.cumsum(seq_lens[:-1], dim=0)\n         total_num_tokens = int(torch.sum(seq_lens))\n         max_seq_len = int(torch.max(seq_lens))\n@@ -353,8 +357,8 @@ class ModelRunner:\n         \"\"\"We need to run a small matmul to init cublas. Otherwise, it will raise some errors later.\"\"\"\n         dtype = torch.float16\n         device = \"cuda\"\n-        a = torch.ones((16, 16), dtype=dtype, device=device)\n-        b = torch.ones((16, 16), dtype=dtype, device=device)\n+        a = torch.empty((16, 16), dtype=dtype, device=device)\n+        b = torch.empty((16, 16), dtype=dtype, device=device)\n         c = a @ b\n         return c\n \ndiff --git a/python/sglang/srt/server.py b/python/sglang/srt/server.py\nindex e28530889..93c5c6201 100644\n--- a/python/sglang/srt/server.py\n+++ b/python/sglang/srt/server.py\n@@ -251,7 +251,7 @@ def launch_server(server_args: ServerArgs, pipe_finish_writer, model_overide_arg\n \n         # Wait until the server is launched\n         for _ in range(120):\n-            time.sleep(0.5)\n+            time.sleep(0.3)\n             try:\n                 requests.get(url + \"/get_model_info\", timeout=5, headers=headers)\n                 break\n", "model_name_or_path": "gpt-5-2025-08-07"}
