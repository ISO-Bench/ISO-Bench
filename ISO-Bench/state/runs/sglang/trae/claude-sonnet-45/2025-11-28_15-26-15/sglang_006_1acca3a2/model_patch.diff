diff --git a/python/sglang/srt/layers/attention/flashattention_backend.py b/python/sglang/srt/layers/attention/flashattention_backend.py
index 9579b19f2..a668cbcb4 100644
--- a/python/sglang/srt/layers/attention/flashattention_backend.py
+++ b/python/sglang/srt/layers/attention/flashattention_backend.py
@@ -338,7 +338,7 @@ class FlashAttentionBackend(AttentionBackend):
         """Initialize forward metadata hence all layers in the forward pass can reuse it."""
         metadata = FlashAttentionMetadata()
         seqlens_in_batch = forward_batch.seq_lens
-        batch_size = len(seqlens_in_batch)
+        batch_size = forward_batch.batch_size
         device = seqlens_in_batch.device
 
         if forward_batch.forward_mode.is_decode_or_idle():
@@ -1130,20 +1130,20 @@ class FlashAttentionBackend(AttentionBackend):
 
         # This is being used by normal decode and draft decode when topk == 1
         self.decode_cuda_graph_metadata = {
-            "cache_seqlens": torch.zeros(max_bs, dtype=torch.int32, device=self.device),
+            "cache_seqlens": torch.empty(max_bs, dtype=torch.int32, device=self.device),
             "cu_seqlens_q": torch.arange(
                 0, max_bs + 1, dtype=torch.int32, device=self.device
             ),
-            "cu_seqlens_k": torch.zeros(
+            "cu_seqlens_k": torch.empty(
                 max_bs + 1, dtype=torch.int32, device=self.device
             ),
-            "page_table": torch.zeros(
+            "page_table": torch.empty(
                 max_bs,
                 (self.max_context_len + self.page_size - 1) // self.page_size,
                 dtype=torch.int32,
                 device=self.device,
             ),
-            "page_table_draft_decode": torch.zeros(
+            "page_table_draft_decode": torch.empty(
                 max_bs,
                 (self.max_context_len + self.page_size - 1) // self.page_size,
                 dtype=torch.int32,
@@ -1157,7 +1157,7 @@ class FlashAttentionBackend(AttentionBackend):
         # This is used by draft decode's first half of metadata when topk > 1
         if self.topk > 1:
             self.draft_decode_metadata_topk_normal = {
-                "cache_seqlens": torch.zeros(
+                "cache_seqlens": torch.empty(
                     max_bs, dtype=torch.int32, device=self.device
                 ),
                 "cu_seqlens_q": torch.arange(
@@ -1167,10 +1167,10 @@ class FlashAttentionBackend(AttentionBackend):
                     dtype=torch.int32,
                     device=self.device,
                 ),
-                "cu_seqlens_k": torch.zeros(
+                "cu_seqlens_k": torch.empty(
                     max_bs + 1, dtype=torch.int32, device=self.device
                 ),
-                "page_table": torch.zeros(
+                "page_table": torch.empty(
                     max_bs,
                     self.max_context_len,
                     dtype=torch.int32,
@@ -1200,7 +1200,7 @@ class FlashAttentionBackend(AttentionBackend):
                     dtype=torch.int32,
                     device=self.device,
                 ),
-                "page_table": torch.zeros(
+                "page_table": torch.empty(
                     max_bs * self.topk,
                     decode_length,
                     dtype=torch.int32,
@@ -1213,7 +1213,7 @@ class FlashAttentionBackend(AttentionBackend):
             and self.speculative_num_draft_tokens > 0
         ):
             self.target_verify_metadata = {
-                "cache_seqlens": torch.zeros(
+                "cache_seqlens": torch.empty(
                     max_bs, dtype=torch.int32, device=self.device
                 ),
                 "cu_seqlens_q": torch.arange(
@@ -1223,10 +1223,10 @@ class FlashAttentionBackend(AttentionBackend):
                     dtype=torch.int32,
                     device=self.device,
                 ),
-                "cu_seqlens_k": torch.zeros(
+                "cu_seqlens_k": torch.empty(
                     max_bs + 1, dtype=torch.int32, device=self.device
                 ),
-                "page_table": torch.zeros(
+                "page_table": torch.empty(
                     max_bs,
                     (self.max_context_len + self.page_size - 1) // self.page_size,
                     dtype=torch.int32,
@@ -1239,7 +1239,7 @@ class FlashAttentionBackend(AttentionBackend):
 
         if self.topk > 1:
             self.target_verify_metadata_topk_normal = {
-                "cache_seqlens": torch.zeros(
+                "cache_seqlens": torch.empty(
                     max_bs, dtype=torch.int32, device=self.device
                 ),
                 "cu_seqlens_q": torch.arange(
@@ -1249,10 +1249,10 @@ class FlashAttentionBackend(AttentionBackend):
                     dtype=torch.int32,
                     device=self.device,
                 ),
-                "cu_seqlens_k": torch.zeros(
+                "cu_seqlens_k": torch.empty(
                     max_bs + 1, dtype=torch.int32, device=self.device
                 ),
-                "page_table": torch.zeros(
+                "page_table": torch.empty(
                     max_bs,
                     self.max_context_len,
                     dtype=torch.int32,
@@ -1261,12 +1261,12 @@ class FlashAttentionBackend(AttentionBackend):
             }
 
             self.target_verify_metadata_topk_expand = {
-                "cache_seqlens": torch.zeros(
+                "cache_seqlens": torch.empty(
                     max_bs * self.speculative_num_draft_tokens,
                     dtype=torch.int32,
                     device=self.device,
                 ),
-                "cu_seqlens_k": torch.zeros(
+                "cu_seqlens_k": torch.empty(
                     max_bs * self.speculative_num_draft_tokens + 1,
                     dtype=torch.int32,
                     device=self.device,
@@ -1277,7 +1277,7 @@ class FlashAttentionBackend(AttentionBackend):
                     dtype=torch.int32,
                     device=self.device,
                 ),
-                "page_table": torch.zeros(
+                "page_table": torch.empty(
                     max_bs * self.speculative_num_draft_tokens,
                     self.speculative_num_draft_tokens,
                     dtype=torch.int32,
@@ -1286,16 +1286,16 @@ class FlashAttentionBackend(AttentionBackend):
             }
 
         self.encoder_metadata = {
-            "encoder_page_table": torch.zeros(
+            "encoder_page_table": torch.empty(
                 max_bs,
                 self.max_context_len,
                 dtype=torch.int32,
                 device=self.device,
             ),
-            "encoder_lens_int32": torch.zeros(
+            "encoder_lens_int32": torch.empty(
                 max_bs, dtype=torch.int32, device=self.device
             ),
-            "encoder_cu_seqlens_k": torch.zeros(
+            "encoder_cu_seqlens_k": torch.empty(
                 max_bs + 1, dtype=torch.int32, device=self.device
             ),
         }
@@ -1388,7 +1388,7 @@ class FlashAttentionBackend(AttentionBackend):
                 # Normal Decode
                 # Get sequence information
                 metadata.cache_seqlens_int32 = seq_lens.to(torch.int32)
-                batch_size = len(seq_lens)
+                batch_size = bs
                 device = seq_lens.device
                 metadata.cu_seqlens_k = torch.nn.functional.pad(
                     torch.cumsum(seq_lens, dim=0, dtype=torch.int32), (1, 0)
