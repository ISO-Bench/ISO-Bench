id: "sglang_core"
name: "SGLang core performance"
description: "Run SGLang performance checks with Dockerfile-based env"

repo:
  url: "https://github.com/sgl-project/sglang.git"
  human_commit: "021f76e4f49861b2e9ea9ccff06a46d577e3c548"
  # pre_commit omitted â†’ defaults to the first parent of human_commit

runner:
  requires_gpu: false
  cuda_version: null
  python_version: null
  platform: "linux/amd64"
  allow_network_during_prepare: true
  allowed_env: []

env_build:
  allowed_strategies:
    - "dockerfile"
    - "requirements"
  params:
    dockerfile_path: null
    requirements_file: null

optimization_contract:
  strict_targets: false
  target_files: []
  constraints:
    - "No public API breakage"
    - "All TestPack checks must pass"

# TRAE CLI configuration
agents:
  trae:
    args:
      max_steps: 120

testpack:
  entrypoint: "../sglang-bench-generic"
  version_constraint: ">=0.1.0"

metrics:
  - name: "throughput_req_per_s"
    using: "runtime:throughput"
    args:
      cmd: "python -c \"print(1.0)\""
      warmups: 1
      trials: 3
      duration_s: 1
  - name: "functional_match"
    using: "quality:hash_match"
    args:
      ref: "human.json"
      candidate: "{candidate}.json"

scoring:
  primary: "functional_match"
  tie_breaker: "throughput_req_per_s"

