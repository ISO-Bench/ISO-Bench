I created a quick local benchmark, optimized the hot paths, and verified significant speedups.
